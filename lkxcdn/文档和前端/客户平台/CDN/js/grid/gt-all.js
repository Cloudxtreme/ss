if(!window.Sigma){window.Sigma={}}Sigma.Const=Sigma.Const||{};SigmaConst=Sigma.Const;Sigma.Const.Grid={COL_CLASS_PREFIX:"td.",DEFAULT_ECG_ID:"gt",SHADOW_ROW:"_shadowRow",HIDE_HEADER_ROW:"_hideListRow",COL_T_CLASSNAME:"gt-col-",SKIN_CLASSNAME_PREFIX:"gt-skin-",SCROLLBAR_WIDTH:18,MIN_COLWIDTH:40,AJAX_HEADER:["isAjaxRequest","true"]};Sigma.Const.Key={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,PAUSE:19,CAPSLOCK:20,ESC:27,SPACE:33,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,WIN:91,WIN_R:92,MENU:93,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SCROLLLOCK:145};if(!window.Sigma){window.Sigma={}}Sigma.loaded=false;Sigma.init=function(b){b=b||window;Sigma.doc=document;b.undefined=b.undefined;var a=b.navigator.userAgent.toLowerCase();Sigma.isIE=a.indexOf("msie")>-1;Sigma.isIE7=a.indexOf("msie 7")>-1;Sigma.isIE8=a.indexOf("msie 8")>-1;Sigma.isIE9=a.indexOf("msie 9")>-1;Sigma.isFF=a.indexOf("firefox")>-1;Sigma.isFF1=a.indexOf("firefox/1")>-1;Sigma.isFF2=a.indexOf("firefox/2")>-1;Sigma.isFF3=a.indexOf("firefox/3")>-1;Sigma.isOpera=a.indexOf("opera")>-1;Sigma.isWebkit=(/webkit|khtml/).test(a);Sigma.isSafari=a.indexOf("safari")>-1||Sigma.isWebkit;Sigma.isChrome=a.indexOf("chrome")>-1||Sigma.isWebkit;Sigma.isGecko=Sigma.isMoz=!Sigma.isSafari&&a.indexOf("gecko")>-1;Sigma.isStrict=Sigma.doc.compatMode=="CSS1Compat"||Sigma.isSafari;Sigma.isBoxModel=Sigma.isIE&&!Sigma.isIE8&&!Sigma.isIE9&&!Sigma.isStrict;Sigma.isNotStrictIE=Sigma.isBoxModel;Sigma.isSecure=b.location.href.toLowerCase().indexOf("https")===0;Sigma.isWindows=(a.indexOf("windows")!=-1||a.indexOf("win32")!=-1);Sigma.isMac=(a.indexOf("macintosh")!=-1||a.indexOf("mac os x")!=-1);Sigma.isLinux=(a.indexOf("linux")!=-1)};Sigma.init();Sigma.$extend=function(d,a,c){if(arguments.length<2){a=d;d=this}for(var e in a){var b=a[e];if(c&&b&&Sigma.$type(b,"object","array")){b=Sigma.$clone(b,c)}if(b!==undefined){d[e]=b}}return d};Sigma.$extend(Sigma,{$empty:function(){},$chk:function(a){return !!(a||a===0||a==="")},$type:function(d){var b=arguments.length;if(b>1){for(var a=1;a<b;a++){if(Sigma.$type(d)==arguments[a]){return true}}return false}var c=typeof d;if(d===null){return"object"}if(c=="undefined"){return"undefined"}if(d.htmlElement){return"element"}if(c=="object"&&d.nodeType&&d.nodeName){switch(d.nodeType){case 1:return"element";case 3:return(/\S/).test(d.nodeValue)?"textnode":"whitespace"}}if(Sigma.U.isArray(d)){return"array"}if(c=="object"&&typeof d.length=="number"){return(d.callee)?"arguments":"collection"}else{if(c=="function"&&typeof d.length=="number"&&d[0]!==undefined){return"collection"}}return c},$merge:function(){var c={};for(var b=0;b<arguments.length;b++){for(var e in arguments[b]){var a=arguments[b][e];var d=c[e];if(d&&Sigma.$type(a,"object")&&Sigma.$type(d,"object")){c[e]=Sigma.$merge(d,a)}else{c[e]=a}}}return c},$indexOf:function(a,d,e){if(a){e=e||0;for(var c=e,b=a.length;c<b;c++){if(a[c]===d){return c}}}return -1},$array:function(f,g,a,c){var e=[];if(f){if(!Sigma.$chk(g)){g=0}if(!Sigma.$chk(a)){a=f.length}if(Sigma.$type(f,"arguments","collection")||Sigma.$type(f,"array")&&(g>0||a<f.length)){for(var d=g;d<a;d++){e.push(f[d])}}else{if(Sigma.$type(f,"array")){e=e.concat(f)}else{for(var b in f){if(f.hasOwnProperty(b)){e.push(f[b])}}}}}return e},$clone:function(c,b){var a;if(!c){a=c}else{if(Sigma.$type(c,"array","arguments","collection")){a=Sigma.$array(c,0,c.length,b)}else{a=Sigma.$extend({},c,b)}}return a},$msg:function(b,c){for(var a=1;a<arguments.length;a++){b=Sigma.U.replaceAll(b,"#{"+a+"}",arguments[a])}return b},$clear:function(a){window.clearTimeout(a);window.clearInterval(a);if(CollectGarbage){CollectGarbage()}return null},$thread:function(b,c){var a=b;window.setTimeout(a,c||20)},$each:function(g,f,h,a){var d=[];if(Sigma.$type(g,"array","arguments","collection")||g&&!Sigma.$type(g,"string")&&Sigma.$type(g.length,"number")){for(var e=0,c=g.length;e<c;e++){d.push(f.call(h||g,g[e],e,g,a))}}else{for(var b in g){d.push(f.call(h||g,g[b],b,g,a))}}return d},$getText:function(a){return a.innerText===undefined?a.textContent:a.innerText},$element:function(d,c){if(Sigma.$type(d,"string")){if(Sigma.isIE&&c&&(c.name||c.type)){var a=(c.name)?' name="'+c.name+'"':"";var b=(c.type)?' type="'+c.type+'"':"";delete c.name;delete c.type;d="<"+d+a+b+">"}d=Sigma.doc.createElement(d)}if(c){if(c.style){Sigma.$extend(d.style,c.style);delete c.style}Sigma.$extend(d,c)}return d}});Sigma.Class=function(b){b=b||{};var a=function(){var d=this.properties;if(Sigma.$type(d,"function")){d=d.apply(this,arguments)}if(Sigma.$type(d,"object")){Sigma.$extend(this,d)}var c=this.abstractMethods;Sigma.$each(this.abstractMethods,function(e){this[e]=Sigma.$empty},this);return(arguments[0]!==Sigma.$empty&&Sigma.$type(this.initialize,"function"))?this.initialize.apply(this,arguments):this};Sigma.$extend(a,this);a.constructor=Sigma.Class;a.prototype=b;return a};Sigma.Class.prototype={extend:function(){var e=new this(Sigma.$empty);for(var d=0,b=arguments.length;d<b;d++){var c=arguments[d];for(var f in c){var a=e[f];e[f]=Sigma.Class.merge(a,c[f])}}return new Sigma.Class(e)}};Sigma.Class.merge=function(c,d){if(c&&c!=d){var b=Sigma.$type(d);if(!Sigma.$type(c,b)){return d}switch(b){case"function":var a=function(){this._parent=arguments.callee._parent;return d.apply(this,arguments)};a._parent=c;return a;case"object":return Sigma.$merge(c,d)}}return d};Sigma.$class=function(a){return new Sigma.Class(a)};Sigma.$e=Sigma.$element;Sigma.$A=Sigma.$array;Sigma.$byId=function(b,c){if(!Sigma.$chk(b)){return null}var a=Sigma.$type(b);if(a=="element"){return Sigma.$e(b,c)}if(a=="string"||a=="number"){b=Sigma.doc.getElementById(""+b)}if(!b){return null}if(Sigma.U.contains(["object","embed"],!b.tagName?b.tagName.toLowerCase():"")){return b}return Sigma.$e(b)};Sigma.getDom=function(a){if(!a||!document){return null}return a.dom?a.dom:(typeof a=="string"?document.getElementById(a):a)};Sigma.$byName=function(d){var b=[];if(!Sigma.$chk(d)){return b}var a=Sigma.doc.getElementsByName(""+d);if(!a||a.length<1){return b}for(var c=0;c<a.length;c++){d=a[c];b.push(Sigma.U.contains(["object","embed"],d.tagName.toLowerCase())?d:Sigma.$e(d))}return b};Sigma.$=function(b){var a=Sigma.$byName(b);if(a&&a.length>0){return a[0]}return(!a||a.length<1)?Sigma.$byId(b):a};Sigma.Utils={P_START:"@{",P_END:"}",P_VAR_NAME:"obj_in",parseExpression:function(ex,pName,argNames,pStart,pEnd){pStart=pStart||Sigma.U.P_START;pEnd=pEnd||Sigma.U.P_END;pName=pName||Sigma.U.P_VAR_NAME;argNames=argNames||pName;var startLength=pStart.length;var endLength=pEnd.length;var templateC=[];var current=0;while(true){var start=ex.indexOf(pStart,current);var sBegin=start+startLength;var sEnd=ex.indexOf(pEnd,sBegin);var str=null;var val=null;if(sBegin>=startLength&&sEnd>sBegin){str=ex.substring(current,start);val=ex.substring(sBegin,sEnd)}else{str=ex.substring(current)}str=Sigma.U.escapeString(str);templateC.push(str);if(val===null){break}if(!Sigma.U.isNumber(val)){val=(pName?(pName+"."):"")+val}else{val=(pName?(pName+"["):"")+val+(pName?"]":"")}templateC.push(val);current=sEnd+endLength}var t="function("+argNames+"){ return "+templateC.join("+")+" }";eval("t="+t);return t},isArray:function(b){return Object.prototype.toString.apply(b)==="[object Array]"},isNumber:function(b,a){return b===0||(a?Sigma.$type(b,"number"):(b&&!isNaN(b)))},parseInt:function(a,c){var b=parseInt(a);return isNaN(parseInt(a))?c||0:b},add2Map:function(a,b,c){c=c||{};if(c[a]===undefined){c[a]=b}else{c[a]=[].concat(c[a]);c[a].push(b)}return c},moveItem:function(a,d,e){if(d==e){return a}var c=a[d];var b=a[e];a.splice(e,1,c,b);if(d<e){a.splice(d,1)}else{a.splice(d+1,1)}return a},convert:function(b,a){switch(a){case"int":return parseInt(b);case"float":return parseFloat(b);case"date":return b;default:return b}return b},getTagName:function(a){return a&&a.tagName?String(a.tagName).toUpperCase():null},getParentByTagName:function(b,d,c,a){if(!d){c=Sigma.$event(c);d=Sigma.U.getEventTarget(c)}a=a||6;if(!d){return null}b=b.toLowerCase();while(d&&(a--)>0){if(d.tagName&&d.tagName.toLowerCase()==b){return d}if(Sigma.U.hasClass(d.className,"gt-grid")&&b!="div"){break}d=d.parentNode}return null},focus:function(a){if(a){try{a.focus();a.select&&a.select()}catch(b){}}},hasClass:function(b,a){return b?Sigma.U.hasSubString(b.className,a," "):false},addClass:function(b,a){if(b&&!Sigma.U.hasClass(b,a)){b.className=Sigma.U.clean(b.className+" "+a)}return b},removeClass:function(b,a){if(b){b.className=Sigma.U.clean(b.className.replace(new RegExp("(^|\\s)"+a+"(?:\\s|$)"),"$1"))}return b},toggleClass:function(b,a){return Sigma.U.hasClass(b,a)?Sigma.U.removeClass(b,a):Sigma.U.addClass(b,a)},hasSubString:function(c,a,b){return(b)?(b+c+b).indexOf(b+a+b)>-1:c.indexOf(a)>-1},childElement:function(c,a){var b=0;var d=c?c.firstChild:null;while(d){if(d.nodeType==1){if(++b==a){return d}}d=d.nextSibling}return null},firstChildElement:function(a){return Sigma.U.childElement(a,1)},lastChildElement:function(b){var a=b.childNodes[b.childNodes.length-1];return a.nodeType==1?a:Sigma.U.prevElement(a)},nextElement:function(a){while((a=a.nextSibling)&&a.nodeType!=1){}return a},prevElement:function(a){while((a=a.previousSibling)&&a.nodeType!=1){}return a},getCellIndex:function(d){if(Sigma.isIE){var b=d.parentNode.cells;for(var c=0,a=b.length;c<a;c++){if(b[c]===d){return c}}}return d.cellIndex},insertNodeBefore:function(b,a){if(!b||!a||!a.parentNode){return null}a.parentNode.insertBefore(b,a);return b},insertNodeAfter:function(b,a){a.parentNode.insertBefore(b,a.nextSibling);return b},listToMap:function(b){var c={};for(var a=0;a<b.length;a++){c[b[a]]=b[a]}return c},createSelect:function(d,a,b,e){e=e||Sigma.$e("select",b||{});var c=Sigma.doc.createDocumentFragment();Sigma.$each(d,function(g,f){var h=Sigma.$e("option",{value:f,text:""+g,innerHTML:g});if(Sigma.$chk(a)&&f==a){h.selected=true}c.appendChild(h)});e.appendChild(c);return e},createSelectHTML:function(a,f,c){c=c||{};var b=c.id?(' id="'+c.id+'" '):" ",h=c.className||"",g=c.style?(' style="'+c.style+'" '):" ";var e=["<select"+b+g+'class="gt-input-select '+h+'">'];for(var d in a){var i="";if((f||f===0)&&d==f){i=' selected="selected" '}e.push('<option value="'+d+'" '+i+">"+a[d]+"</option>")}e.push("</select>");return e.join("")},getEventTarget:function(a){var c=null;try{c=a.target||a.srcElement}catch(b){return null}return !c?null:(c.nodeType==3?c.parentNode:c)},stopEvent:function(a){a=a||window.event;if(a){if(a.stopPropagation){a.stopPropagation();a.preventDefault()}else{a.cancelBubble=true;a.returnValue=false}}},addEvent:function(e,d,c,f,b){if(!c||!e||!d){return false}if(arguments.length>3){c=Sigma.U.bindAsEventListener(c,f,b)}if(e.addEventListener){e.addEventListener(d,c,false)}else{var a=d=="selectstart"?d:"on"+d;e.attachEvent(a,c)}Sigma.EventCache.add(e,d,c,false);return e},removeEvent:function(e,d,c,f,b){if(!c||!e||!d){return false}if(arguments.length>3){c=Sigma.U.bindAsEventListener(c,f,b)}if(e.addEventListener){e.removeEventListener(d,c,false)}else{var a=d=="selectstart"?d:"on"+d;e.detachEvent(a,c)}Sigma.EventCache.remove(e,d,c,false);return e},onLoadFuncList:[],onLoadFuncCaller:function(){for(var a=0;a<Sigma.U.onLoadFuncList.length;a++){var b=Sigma.U.onLoadFuncList[a];b.apply(this,arguments)}Sigma.loaded=true},onLoad:function(a,b){b=b||window;Sigma.U.onLoadFuncList.push(a);if(!Sigma.U.onLoadFuncCaller.hasAdd){Sigma.U.addEvent(b,"load",Sigma.U.onLoadFuncCaller);Sigma.U.onLoadFuncCaller.hasAdd=true}},orphanDiv:function(){var a=Sigma.doc.createElement("div");a.className="gt-orphan-div";return a}(),createElementFromHTML:function(a,c){Sigma.U.orphanDiv.innerHTML=a;var b=Sigma.U.firstChildElement(Sigma.U.orphanDiv);c.appendChild(b);Sigma.U.orphanDiv.innerHTML="";return b},createTrFromHTML:function(a,b){Sigma.U.orphanDiv.innerHTML="<table><tbody>"+a+"</tbody></table>";var c=Sigma.U.orphanDiv.getElementsByTagName("tr")[0];b.appendChild(c);Sigma.U.orphanDiv.innerHTML="";return c},removeNode:function(b){for(var a=0;a<arguments.length;a++){var c=arguments[a];if(!c||!c.parentNode||c.tagName=="BODY"){return null}Sigma.EventCache.remove(c);if(Sigma.isIE){Sigma.U.orphanDiv.appendChild(c);Sigma.U.orphanDiv.innerHTML=""}else{c.parentNode.removeChild(c)}}},removeNodeTree:function(c){if(c){var b=c.getElementsByTagName("*");for(var a=0;a<b.length;a++){Sigma.U.removeNodeTree(b[a])}Sigma.U.removeNode(c)}},getLastChild:function(a){return a.childNodes[a.childNodes.length-1]},getPosLeftTop:function(d,c){c=c||window;var b=d.offsetTop;var a=d.offsetLeft;d=d.offsetParent;while(d&&d!=c){b+=(d.offsetTop-d.scrollTop);a+=(d.offsetLeft-d.scrollLeft);d=d.offsetParent}return[a,b]},getPosRight:function(a){return Sigma.U.getPosLeftTop(a)[0]+a.offsetWidth},getPosBottom:function(a){return Sigma.U.getPosLeftTop(a)[1]+a.offsetHeight},getHeight:function(d,e){var c=d.offsetHeight||0;if(e!==true){return c}var b=Sigma.U.getBorderWidths(d);var a=Sigma.U.getPaddings(d);return c-b[0]-b[2]-a[0]-a[2]},getWidth:function(d,e){var a=d.offsetWidth||0;if(e!==true){return a}var c=Sigma.U.getBorderWidths(d);var b=Sigma.U.getPaddings(d);return a-c[1]-c[3]-b[1]-b[3]},getBorderWidths:function(a){return[Sigma.U.parseInt(a.style.borderTopWidth),Sigma.U.parseInt(a.style.borderRightWidth),Sigma.U.parseInt(a.style.borderBottomWidth),Sigma.U.parseInt(a.style.borderLeftWidth)]},getPaddings:function(a){return[Sigma.U.parseInt(a.style.paddingTop),Sigma.U.parseInt(a.style.paddingRight),Sigma.U.parseInt(a.style.paddingBottom),Sigma.U.parseInt(a.style.paddingLeft)]},getPageX:function(b){b=b||window.event;var a=b.pageX;if(!a&&0!==a){a=b.clientX||0;if(Sigma.isIE){a+=Sigma.U.getPageScroll()[0]}}return a},getPageY:function(a){a=a||window.event;var b=a.pageY;if(!b&&0!==b){b=a.clientY||0;if(Sigma.isIE){b+=Sigma.U.getPageScroll()[1]}}return b},getPageScroll:function(){var a=Sigma.doc.documentElement,b=Sigma.doc.body;if(a&&(a.scrollLeft||a.scrollTop)){return[a.scrollLeft,a.scrollTop]}else{if(b){return[b.scrollLeft,a.scrollTop]}else{return[0,0]}}},getScroll:function(c){var f=c,e=Sigma.doc;if(f==e||f==e.body){var a=window.pageXOffset||e.documentElement.scrollLeft||e.body.scrollLeft||0;var b=window.pageYOffset||e.documentElement.scrollTop||e.body.scrollTop||0;return[a,b]}else{return[f.scrollLeft,f.scrollTop]}},getXY:function(d,h){var c,i,k,l,g=Sigma.doc.body;if(d.getBoundingClientRect){k=d.getBoundingClientRect();l=Sigma.U.getScroll(Sigma.doc);return[k.left+l[0],k.top+l[1]]}var m=0,j=0;c=d;h=h||g;var a=d.style.position=="absolute";while(c){m+=c.offsetLeft;j+=c.offsetTop;if(!a&&c.style.position=="absolute"){a=true}if(Sigma.isGecko){i=c;var n=parseInt(i.style.borderTopWidth,10)||0;var e=parseInt(i.style.borderLeftWidth,10)||0;m+=e;j+=n;if(c!=d&&i.style.overflow!="visible"){m+=e;j+=n}}c=c.offsetParent}if(Sigma.isSafari&&a){m-=g.offsetLeft;j-=g.offsetTop}if(Sigma.isGecko&&!a){var f=g;m+=parseInt(f.style.borderTopWidth,10)||0;j+=parseInt(f.style.borderTopWidth,10)||0}c=d.parentNode;while(c&&c!=g){if(!Sigma.isOpera||(c.tagName.toUpperCase()!="TR"&&c.style.display!="inline")){m-=c.scrollLeft;j-=c.scrollTop}c=c.parentNode}return[m,j]},setXY:function(a,b){if(a.style.position=="static"){a.style.position="relative"}var c=Sigma.U.translatePoints(a,b);if(b[0]!==false){a.style.left=c.left+"px"}if(b[1]!==false){a.style.top=c.top+"px"}},translatePoints:function(d,a,g){if(typeof a=="object"||a instanceof Array){g=a[1];a=a[0]}var e=d.style.position;var f=Sigma.U.getXY(d);var b=parseInt(d.style.left,10);var c=parseInt(d.style.top,10);if(isNaN(b)){b=(e=="relative")?0:d.offsetLeft}if(isNaN(c)){c=(e=="relative")?0:d.offsetTop}return{left:(a-f[0]+b),top:(g-f[1]+c)}},getContentWidthHeight:function(e){var g=Sigma.U.parseInt(e.style.marginLeft);var b=Sigma.U.parseInt(e.style.marginRight);var c=Sigma.U.parseInt(e.style.paddingLeft);var f=Sigma.U.parseInt(e.style.paddingRight);var a=e.clientWidth-c-f;var d=e.clientHeight;return[a,d]},getPixelValue:function(a,c){if(Sigma.$type(a,"number")){return a}a=""+a;var b=Sigma.U.parseInt(a);if(a.indexOf("%")>1){return c*b/100}return b},setValue:function(c,d){c=Sigma.$(c);if(!c){return}var a=c.tagName;a=(""+a).toUpperCase();switch(a){case"SELECT":var b=[].concat(d);var e=null;Sigma.$each(c.options,function(g,f){if(f===0){e=g}g.selected=false;if(c.multiple){Sigma.$each(b,function(h){g.selected=g.value==h})}else{if(g.value==b[0]){g.selected=true;e=false}}});if(!c.multiple&&e){e.selected=true}return(c.multiple)?b:b[0];case"INPUT":if(c.type=="checkbox"||c.type=="radio"){c.checked=c.value==d;break}case"TEXTAREA":c.value=d}return null},getValue:function(c){c=Sigma.$(c);if(!c){return}var a=c.tagName;switch(a){case"SELECT":var b=[];Sigma.$each(c.options,function(d){if(d.selected){b.push(d.value)}});b=(c.multiple)?b:b[0];if((b===null||b===undefined)&&c.options[0]){b=c.options[0].value}return b;case"INPUT":if((c.type=="checkbox"||c.type=="radio")&&!c.checked){break}case"TEXTAREA":return c.value}return null},setOpacity:function(b,a){a=a>1?1:(a<0?0:a);if(!b.currentStyle||!b.currentStyle.hasLayout){b.style.zoom=1}if(Sigma.isIE){b.style.filter=(a==1)?"":"alpha(opacity="+a*100+")"}b.style.opacity=a;if(a===0){if(b.style.visibility!="hidden"){b.style.visibility="hidden"}}else{if(b.style.visibility!="visible"){b.style.visibility="visible"}}return b},replaceAll:function(exstr,ov,value){var gc=Sigma.U.escapeRegExp(ov);if(!Sigma.$chk(gc)||gc===""){return exstr}var rep="/"+gc+"/gm";var r=null;var cmd="r=exstr.replace("+rep+","+Sigma.U.escapeString(value)+")";eval(cmd);return r},trim:function(c,a){if(!c||!c.replace||!c.length){return c}var b=(a>0)?(/^\s+/):(a<0)?(/\s+$/):(/^\s+|\s+$/g);return c.replace(b,"")},escapeRegExp:function(a){return !a?""+a:(""+a).replace(/\\/gm,"\\\\").replace(/([\f\b\n\t\r[\^$|?*+(){}])/gm,"\\$1")},escapeString:function(a){return a===""?'""':(!a?""+a:('"'+(""+a).replace(/(["\\])/g,"\\$1")+'"').replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r"))},bind:function(b,c,a){a=[].concat(a);return function(){return b.apply(c||b,Sigma.U.merge(Sigma.$A(arguments),a))}},bindAsEventListener:function(b,c,a){return function(d){d=d||window.event;return b.apply(c||b,[Sigma.$event(d)].concat(a))}},clean:function(a){return Sigma.U.trim(a.replace(/\s{2,}/g," "))},contains:function(a,b,c){return Sigma.U.indexOf(a,b,c)!=-1},merge:function(b,f,a){var d=b.length<f.length?b.length:f.length;var e,c;if(a){for(e=0,c=d;e<c;e++){b[e]=f[e]}}for(e=d,c=f.length;e<c;e++){b[e]=f[e]}return b},each:function(a,b,c){return Sigma.$each(a,b,c)},indexOf:function(b,d,e){var a=b.length;for(var c=(e<0)?Math.max(0,a+e):e||0;c<a;c++){if(b[c]===d){return c}}return -1},remove:function(b,e,d){var c=0;var a=b.length;while(c<a){if(b[c]===e){b.splice(c,1);if(!d){return b}a--}else{c++}}return b},next:function(a,c){var b=Sigma.U.indexOf(a,c);if(b<0){return null}return a[b+1]},previous:function(a,c){var b=Sigma.U.indexOf(a,c);if(b<1){return null}return a[b-1]},createStyleSheet:function(d,c){c=c||Sigma.doc;var b=c.createElement("style");b.id=d;var a=c.getElementsByTagName("head")[0];a&&a.appendChild(b);return b},getCheckboxState:function(a,c){var b={};for(var d=0;d<a.length;d++){if(a[d].name==c&&a[d].checked){b[a[d].value]=a[d].checked}}return b}};Sigma.Util=Sigma.Utils;Sigma.U=Sigma.Utils;Sigma.Utils.CSS=function(){var a=null;return{createStyleSheet:function(d,j,g){var c;g=g||Sigma.doc;var f=g.getElementsByTagName("head");if(!f||f.length<1){f=g.createElement("head");if(g.documentElement){g.documentElement.insertBefore(f,g.body)}else{g.appendChild(f)}f=g.getElementsByTagName("head")}var b=f[0];var i=g.createElement("style");i.setAttribute("type","text/css");if(j){i.setAttribute("id",j)}if(Sigma.isIE){b.appendChild(i);c=i.styleSheet;c.cssText=d}else{try{i.appendChild(g.createTextNode(d))}catch(h){i.cssText=d}b.appendChild(i);c=i.styleSheet?i.styleSheet:(i.sheet||g.styleSheets[g.styleSheets.length-1])}this.cacheStyleSheet(c);return c},getRules:function(c,f){f=f||Sigma.doc;if(!a||c){a={};var e=f.styleSheets;for(var d=0,b=e.length;d<b;d++){this.cacheStyleSheet(e[d])}}return a},getRule:function(b,d){var c=this.getRules(d);return c[b.toLowerCase()]},updateRule:function(b,d,c){var e=this.getRule(b);if(e){e.style[d]=c}},cacheStyleSheet:function(c){a=a||{};try{var f=c.cssRules||c.rules;for(var b=f.length-1;b>=0;--b){a[f[b].selectorText.toLowerCase()]=f[b]}}catch(d){}}}}();Sigma.$event=function(a){a=a||window.event;return a};Sigma.EventCache=(function(){var c=[];var b=[];var d={};function a(e){return""+e+"_"+e.id}return{add:function(i,h,g){if(!i){return}if(!Sigma.U.contains(c,arguments)){c.push(arguments)}var e=Sigma.U.indexOf(b,i);var f=e+"_"+i+"_"+i.id;if(e<0){f=b.length+"_"+i+"_"+i.id;b.push(i);d[f]={}}d[f][h]=d[f][h]||[];if(!Sigma.U.contains(d[f][h],g)){d[f][h].push(g)}},remove:function(i,h,g){if(!i){return}var e=Sigma.U.indexOf(b,i);var f=e+"_"+i+"_"+i.id;if(e<0||!d[f]){return}if(!h){d[f]=null;b[e]=null;return}if(!g&&d[f][h]){d[f][h]=null;delete d[f][h]}if(d[f][h]){d[f][h].remove(g)}},clearUp:function(){var e,f;for(e=c.length-1;e>=0;e=e-1){f=c[e];Sigma.EventCache.remove(f[0]);if(f[0].removeEventListener){f[0].removeEventListener(f[1],f[2],f[3])}if(f[1].substring(0,2)!="on"){f[1]="on"+f[1]}if(f[0].detachEvent){f[0].detachEvent(f[1],f[2])}f[0][f[1]]=null;delete c[e]}Sigma.destroyGrids&&Sigma.destroyGrids();Sigma.destroyWidgets&&Sigma.destroyWidgets();window.CollectGarbage&&CollectGarbage()}}})();Sigma.toQueryString=function(d){if(!d||Sigma.$type(d,"string","number")){return d}var f=[];for(var c in d){var b=d[c];if(b!==undefined){b=[].concat(b)}for(var a=0;a<b.length;a++){var e=b[a];if(Sigma.$type(e,"object")){e=Sigma.$json(e)}f.push(encodeURIComponent(c)+"="+encodeURIComponent(e))}}return f.join("&")};Sigma.toJSONString=function(a,b){return Sigma.JSON.encode(a,"__gt_",b)};Sigma.$json=Sigma.toJSONString;Sigma.FunctionCache={};Sigma.$invoke=function(c,b,d){c=c||window;var a=c[b]||Sigma.$getFunction(b);if(typeof(a)=="function"){return a.apply(c,d||[])}};Sigma.$getFunction=function(a){return Sigma.FunctionCache[a]};Sigma.$callFunction=function(a,b){Sigma.$invoke(null,a,b)};Sigma.$putFunction=function(b,a){Sigma.FunctionCache[b]=a};Sigma.$removeFunction=function(a){Sigma.FunctionCache[a]=null;delete Sigma.FunctionCache[a]};Sigma.U.onLoad(function(){Sigma.U.addEvent(window,"unload",Sigma.EventCache.clearUp)});Sigma.Navigator=Sigma.$class({properties:function(){return{pageInfo:{pageSize:20,pageNum:1,totalRowNum:0,totalPageNum:1,startRowNum:0,endRowNum:0}}},inited:false,initialize:function(a){var b=a.pageInfo||{};delete a.pageInfo;Sigma.$extend(this,a);Sigma.$extend(this.pageInfo,b)},destroy:function(){var a=this;var b=["firstPageButton","prevPageButton","nextPageButton","lastPageButton","gotoPageButton"];Sigma.$each(b,function(c,d){if(a[c]&&a[c].destroy){a[c].destroy()}a[c]=null});Sigma.U.removeNode(this.pageInput);this.pageInput=null},buildNavTools:function(){var a=Sigma.$grid(this.gridId);this.firstPageButton=new Sigma.Button({container:a.toolBar,cls:"gt-first-page",onclick:this.gotoFirstPage,onclickArgs:[this]});this.prevPageButton=new Sigma.Button({container:a.toolBar,cls:"gt-prev-page",onclick:this.gotoPrevPage,onclickArgs:[this]});this.nextPageButton=new Sigma.Button({container:a.toolBar,cls:"gt-next-page",onclick:this.gotoNextPage,onclickArgs:[this]});this.lastPageButton=new Sigma.Button({container:a.toolBar,cls:"gt-last-page",onclick:this.gotoLastPage,onclickArgs:[this]});this.inited=true;if(!a.loading){this.refreshState()}},createGotoPage:function(){var a=Sigma.$grid(this.gridId);this.gotoPageButton=new Sigma.Button({container:a.toolBar,cls:"gt-goto-page",onclick:this.gotoInputPage,onclickArgs:[this],text:a.getMsg("GOTOPAGE_BUTTON_TEXT")});if(a.toolBar){var c,b;this.pageInput=Sigma.$e("input",{type:"text",className:"gt-page-input"});var d=this;Sigma.U.addEvent(this.pageInput,"keydown",function(e){var f=e.keyCode;if(f==Sigma.Const.Key.ENTER){Sigma.U.stopEvent(e);d.gotoInputPage(e,d)}});c=Sigma.$e("div",{innerHTML:a.getMsg("PAGE_BEFORE"),className:"gt-toolbar-text"});b=Sigma.$e("div",{innerHTML:a.getMsg("PAGE_AFTER"),className:"gt-toolbar-text"});a.toolBar.appendChild(c);a.toolBar.appendChild(Sigma.Button.createToolComp(this.pageInput));a.toolBar.appendChild(b)}},refreshState:function(b,d){this.pageInfo=(b||this.pageInfo);var c=this.pageInfo;if(d!==false){if(c.totalRowNum<1){var a=Sigma.$grid(this.gridId);c.totalRowNum=a.dataset.getSize()}c.totalPageNum=Math.ceil(c.totalRowNum/c.pageSize);c.pageNum=c.pageNum>c.totalPageNum?c.totalPageNum:c.pageNum;c.pageNum=c.pageNum<1?1:c.pageNum;c.startRowNum=(c.pageNum-1)*c.pageSize+1;c.startRowNum=isNaN(c.startRowNum)?1:c.startRowNum;c.endRowNum=c.startRowNum/1+c.pageSize/1-1;c.endRowNum=c.endRowNum>c.totalRowNum?c.totalRowNum:c.endRowNum}return c},refreshNavBar:function(b){this.pageInfo=(b||this.pageInfo);var c=this.pageInfo;var a=Sigma.$grid(this.gridId);if(this.inited){if(this.pageInput){this.pageInput.value=c.pageNum;this.pageInput.gt_maxlength=(""+c.totalPageNum).length}if(c.pageNum==1){this.firstPageButton.disable();this.prevPageButton.disable()}else{this.firstPageButton.enable();this.prevPageButton.enable()}if(c.pageNum==c.totalPageNum){this.nextPageButton.disable();this.lastPageButton.disable()}else{this.nextPageButton.enable();this.lastPageButton.enable()}}if(a&&a.pageSizeSelect){a.pageSizeList=!a.pageSizeList||a.pageSizeList.length<1?[a.pageSize]:a.pageSizeList;a.pageSizeSelect.innerHTML="";Sigma.U.createSelect(Sigma.U.listToMap(a.pageSizeList),this.pageInfo.pageSize,{},a.pageSizeSelect)}},gotoPage:function(b,e,a){b=b||this;var d=b.pageInfo.pageNum;var c=Sigma.$grid(b.gridId);e=(!e||e<1)?1:(e>b.pageInfo.totalPageNum?b.pageInfo.totalPageNum:e);if(Sigma.$invoke(c,"beforeGotoPage",[e,d,b,c])!==false){c.lastAction=a;c.gotoPage(e,d)}},gotoInputPage:function(b,a){a.gotoPage(a,Sigma.U.parseInt(a.pageInput.value,a.pageInfo.pageNum),"gotoPage")},gotoFirstPage:function(b,a){a.gotoPage(a,1,"firstPage")},gotoPrevPage:function(b,a){a.gotoPage(a,a.pageInfo.pageNum-1,"prevPage")},gotoNextPage:function(b,a){a.gotoPage(a,a.pageInfo.pageNum+1,"nextPage")},gotoLastPage:function(b,a){a.gotoPage(a,a.pageInfo.totalPageNum,"lastPage")},refreshPage:function(b,a){a.gotoPage(a,a.pageInfo.pageNum,"refreshPage")}});Sigma.BaseMenuItem=Sigma.$class({id:null,gridId:null,cls:null,type:null,onclickArgs:null,parentItem:null,reference:null,container:null,text:null,toolTip:null,itemBox:null,itemIcon:null,itemText:null,itemAfterIcon:null,subMenu:null,initialize:function(a){this.disabled=false;this.withSeparator=false;this.overShowSubMenu=true;this.onclick=Sigma.$empty;Sigma.$extend(this,a);this.toolTip=this.toolTip||this.text||""},destroy:function(){if(this.subMenu){this.subMenu.destroy()}this.container=null;this.parentItem=null;if(this.separator){Sigma.U.removeNode(this.separator);this.separator=null}Sigma.U.removeNode(this.itemIcon);this.itemIcon=null;Sigma.U.removeNode(this.itemText);this.itemText=null;Sigma.U.removeNode(this.itemAfterIcon);this.itemAfterIcon=null;Sigma.U.removeNode(this.itemBox);this.itemBox=null},onclickAction:function(d,a){Sigma.activeGrid&&Sigma.activeGrid.endEdit();var e=a.subMenu?a.subMenu.hidden:false;if(a.parentItem){(a.parentItem.closeSubMenu)&&a.parentItem.closeSubMenu(d);if(a.parentItem.currenItem){Sigma.U.removeClass(a.parentItem.currenItem.itemBox,"gt-menu-activemenu")}a.parentItem.currenItem=a;Sigma.U.addClass(a.itemBox,"gt-menu-activemenu")}if(a.disabled||a.onclick.apply(a,[d].concat(a.onclickArgs||a))===false){Sigma.U.stopEvent(d);return}Sigma.U.stopEvent(d);if(a.type=="checkbox"){a.toggleCheck()}else{if(a.type=="radiobox"){var c=a.parentItem.itemList;for(var b=0;b<c.length;b++){if(c[b].type=="radiobox"&&c[b]!=a){c[b].uncheckMe()}}a.checkMe()}}if(a.subMenu){if(e){a.showMenu(d)}else{a.closeMenu(d)}}},closeSubMenu:Sigma.$empty,checkMe:function(){Sigma.U.removeClass(this.itemIcon,"gt-icon-unchecked");Sigma.U.addClass(this.itemIcon,"gt-icon-"+this.type);this.checked=true},uncheckMe:function(){Sigma.U.removeClass(this.itemIcon,"gt-icon-"+this.type);Sigma.U.addClass(this.itemIcon,"gt-icon-unchecked");this.checked=false},toggleCheck:function(){if(this.checked===true){this.uncheckMe()}else{this.checkMe()}},disable:function(){Sigma.U.addClass(this.itemBox,"gt-button-disable");this.disabled=true},enable:function(){Sigma.U.removeClass(this.itemBox,"gt-button-disable");this.disabled=false},getMenuPosition:function(){if(this.subMenu){return this.subMenu.position}return null},setMenuPosition:function(a){if(this.subMenu&&a){this.subMenu.position=a}},showMenu:function(a){if(this.subMenu){if(!this.getMenuPosition()){this.setMenuPosition("R")}this.subMenu.show(a)}},toggleMenu:function(a){if(this.subMenu){if(!this.getMenuPosition()){this.setMenuPosition("R")}this.subMenu.toggle(a)}},closeMenu:function(a){var b=this;while((b=b.subMenu)){b.close(a)}},addMenuItems:function(b,a){if(b){if(!this.subMenu){this.subMenu=new Sigma.GridMenu({gridId:this.gridId,parentItem:this,reference:this.itemBox});this.itemAfterIcon&&Sigma.U.addClass(this.itemAfterIcon,"gt-menu-parent")}b.gridId=this.gridId;this.setMenuPosition(a);this.subMenu.addMenuItems(b)}return this}});Sigma.Button=Sigma.BaseMenuItem.extend({initialize:function(a){this.className="gt-image-button";this.clickClassName="gt-image-button-down";this._parent(a);if(!this.container){return}this.itemBox=Sigma.$e("a",{href:"javascript:void(0);return false;",className:this.className,title:this.toolTip});this.itemIcon=Sigma.$e("div",{className:this.cls});this.itemBox.appendChild(this.itemIcon);this.container.appendChild(this.itemBox);if(this.withSeparator){Sigma.Button.createSeparator(this.container)}var b=this;Sigma.U.addEvent(b.itemBox,"mousedown",function(c){if(!b.disabled){Sigma.U.addClass(b.itemBox,b.clickClassName)}});Sigma.U.addEvent(b.itemBox,"mouseup",function(c){if(!b.disabled){Sigma.U.removeClass(b.itemBox,b.clickClassName)}});Sigma.U.addEvent(b.itemBox,"click",function(c){b.onclickAction(c,b)});Sigma.U.addEvent(b.itemBox,"dblclick",function(c){b.onclickAction(c,b)})}});Sigma.$extend(Sigma.Button,{createSeparator:function(b){var a=Sigma.$e("div",{className:"gt-image-button gt-button-split"});if(b){b.appendChild(a)}return a},createCommonButton:function(d,b,f,c,a,e){return new Sigma.Button({id:d,container:a,cls:b,onclick:f,onclickArgs:c,withSeparator:e})},createToolComp:function(a){var b=Sigma.$e("div",{className:"gt-toolbar-comp"});if(a){if(Sigma.$type(a,"string","number")){b.innerHTML=a}else{b.appendChild(a)}}return b}});Sigma.MenuItem=Sigma.BaseMenuItem.extend({initialize:function(a){this._parent(a);if(this.type=="checkbox"||this.type=="radiobox"){this.cls=this.checked?("gt-icon-"+this.type):"gt-icon-unchecked"}this.itemBox=Sigma.$e("a",{href:"javascript:void(0);return false;",className:"gt-menuitem"});this.itemIcon=Sigma.$e("div",{className:"gt-menu-icon "+this.cls});this.itemText=Sigma.$e("div",{className:"gt-checkboxtext",innerHTML:this.text,title:this.toolTip});this.itemAfterIcon=Sigma.$e("div",{className:"gt-aftericon "+this.afterIconClassName});this.itemBox.appendChild(this.itemIcon);this.itemBox.appendChild(this.itemText);this.itemBox.appendChild(this.itemAfterIcon);var b=this;Sigma.U.addEvent(b.itemBox,"click",function(c){b.onclickAction(c,b)})}});Sigma.$extend(Sigma.MenuItem,{createSeparator:function(b){var a=Sigma.$e("div",{className:"gt-image-button gt-button-split"});if(b){b.appendChild(a)}return a}});Sigma.GridMenu=Sigma.$class({gridId:null,parentItem:null,container:null,fixX:null,fixY:null,destroy:function(){this.container=null;this.parentItem=null;Sigma.$each(this.itemList,function(a,b,c){Sigma.U.removeNode(a);c[b]=null});this.itemList=null},initialize:function(a){this.itemList=[];this.refreshOnShow=false;this.currenItem=null;this.hidden=true;this.className="gt-popmenu";this.position="";Sigma.$extend(this,a);this.menuBox=Sigma.$e("div",{className:this.className,style:{display:"none",left:"10px",top:"10px"}});var b=Sigma.$grid(this.gridId)||{};this.container=this.container||b.gridDiv||Sigma.doc.body;this.container.appendChild(this.menuBox)},refresh:function(){},onshow:function(){},clearUp:function(){},addMenuItems:function(b){b=[].concat(b);for(var a=0;a<b.length;a++){if(b[a]){b[a].gridId=this.gridId;b[a].parentItem=this;b[a].container=this.menuBox;this.itemList.push(b[a]);this.menuBox.appendChild(b[a].itemBox)}}return this},show:function(b){if(this.container&&this.container.parentNode&&this.container.parentNode.className.indexOf("menu")>1){}this.menuBox.style.display="block";var a,d;var c=Sigma.U.getXY(this.reference,this.container);a=c[0];d=c[1];this.fixX=this.fixX||0;this.fixY=this.fixY||0;switch(this.position.toUpperCase()){case"L":a-=this.menuBox.offsetWidth;break;case"T":d-=this.menuBox.offsetHeight;break;case"R":a+=this.reference.offsetWidth;break;case"B":d+=this.reference.offsetHeight;break;case"LT":a-=this.menuBox.offsetWidth;d-=this.menuBox.offsetHeight-this.reference.offsetHeight;break;case"RT":a+=this.reference.offsetWidth;d-=this.menuBox.offsetHeight-this.reference.offsetHeight;break;case"RB":a+=this.reference.offsetWidth;d+=this.reference.offsetHeight;break;case"LB":a-=this.reference.offsetWidth;d+=this.menuBox.offsetHeight;break;case"M":a=b.pageX||(b.clientX-b.x);d=b.pageY||(b.clientY-b.y);break;default:d+=this.reference.offsetHeight}Sigma.U.setXY(this.menuBox,[a+this.fixX,d+this.fixY]);this.hidden=false},close:function(a){this.closeSubMenu(a);this.menuBox.style.display="none";this.hidden=true},closeSubMenu:function(b){for(var a=0;a<this.itemList.length;a++){this.itemList[a].closeMenu(b)}},toggle:function(b){Sigma.U.stopEvent(b);var a=Sigma.$grid(this.gridId);if(this.hidden===true){this.show(b)}else{this.close(b)}}});Sigma.ToolFactroy={register:function(a,b){Sigma.ToolFactroy.tools[a]=b},create:function(c,d,a){if(a===false){return false}c=Sigma.$grid(c);var g=c;if(d=="info"||d=="pagestate"){d="state"}var f=Sigma.ToolFactroy.tools[d];if(f&&Sigma.$type(f,"function")){f=f(c,d,a)}else{if(f){var b=f.name||d;var e=f.onclick||f.action;f=new Sigma.Button({container:f.container||c.toolBar,cls:f.cls||"gt-tool-"+b,toolTip:f.toolTip||c.getMsg("TOOL_"+b.toUpperCase()),onclick:function(h){e(h,c)}})}}return f},tools:{"goto":function(a){return a.navigator.createGotoPage()},pagesize:function(a){var e=Sigma.U.createSelect({});e.className="gt-pagesize-select";a.pageSizeSelect=e;function c(f){a.setPageInfo({pageSize:e.value/1});a.navigator.gotoFirstPage(f,a.navigator);a.pageSizeSelect.blur();try{a.bodyDiv.focus()}catch(g){}}Sigma.U.addEvent(a.pageSizeSelect,"change",c);var d=Sigma.$e("div",{innerHTML:a.getMsg("PAGESIZE_BEFORE"),className:"gt-toolbar-text"});var b=Sigma.$e("div",{innerHTML:a.getMsg("PAGESIZE_AFTER"),className:"gt-toolbar-text"});a.toolBar.appendChild(d);a.toolBar.appendChild(Sigma.Button.createToolComp(a.pageSizeSelect));a.toolBar.appendChild(b);return e},add:{onclick:function(b,a){a.addRow()}},del:{onclick:function(b,a){if(a.readOnly||a.endEdit()===false){return}a.deleteRow()}},save:{onclick:function(b,a){a.lastAction="save";a.save()}},reload:{onclick:function(b,a){a.lastAction="reload";a.reload()}},print:{onclick:function(b,a){a.lastAction="print";a.printGrid()}},xls:{onclick:function(b,a){a.lastAction="export";a.exportGrid("xls")}},pdf:{onclick:function(b,a){a.lastAction="export";a.exportGrid("pdf")}},csv:{onclick:function(b,a){a.lastAction="export";a.exportGrid("csv")}},xml:{onclick:function(b,a){a.lastAction="export";a.exportGrid("xml")}},filter:{onclick:function(b,a){a.lastAction="filter";a.showDialog("filter")}},chart:{onclick:function(b,a){a.showDialog("chart")}},state:function(b){var a=Sigma.$e("div",{innerHTML:"&#160;",className:"gt-page-state"});b.toolBar.appendChild(a);return a},separator:function(b){var a=Sigma.Button.createSeparator(b.toolBar);return a},fill:function(b){var a="";return a}}};Sigma.Widget=Sigma.$class({id:null,dom:null,setDom:function(a){this.dom=a},getDom:function(){return this.dom},show:function(){this.dom&&(this.dom.style.display="block")},hide:function(){this.dom&&(this.dom.style.display="none")},close:function(){this.hide()},setPosition:function(a,b){if(a||a===0){this.left=a;this.dom&&(this.dom.style.left=this.left+"px")}if(b||b===0){this.top=b;this.dom&&(this.dom.style.top=this.top+"px")}},setSize:function(a,b){this.width=a||this.width;this.height=b||this.height;if(!this.dom){return}if(this.width/1&&this.width>0){this.dom.style.width=(this.width-1)+"px"}if(this.height/1&&this.height>0){this.dom.style.height=(this.height-1)+"px"}},destroy:function(){Sigma.$invoke(this,"beforeDestroy");Sigma.U.removeNode(this.dom);this.dom=null}});Sigma.Chart=Sigma.$class({initialize:function(a){this.defaultColor="66BBFF";this.type="column2D";this.swfPath="./charts/";this.swf=Sigma.Chart.SWFMapping[this.type];this.width="100%";this.height="100%";this.data=null;this.container=null;this.chart=null;Sigma.$extend(this,a);this.swf=Sigma.Chart.SWFMapping[this.type]||this.swf;if(this.swfPath.lastIndexOf("/")==this.swfPath.length-1){this.swfPath=this.swfPath.substring(0,this.swfPath.length-1)}this.container=Sigma.$(this.container);this.chart=this.chart||new FusionCharts(this.swfPath+"/"+this.swf,this.container.id+"_chart",this.width,this.height)},json2Params:function(b){if(b.isNull){if(b.name){b={name:b.name}}else{return""}}else{if(b.color){b.color=b.color||this.defaultColor}}var c=[];for(var a in b){c.push(a+"='"+b[a]+"'")}return},createSetsXML:function(e){e=e||this.data;var b=[],h=[];for(var f=0;f<e.length;f++){var g=e[f],c,a,j,d;if(g instanceof Array){a=g[0];j=g[1];d=g[2];d=(j===null||j===undefined)?null:(d||this.defaultColor);a=(a===null||a===undefined)?j:a;h=[a!==null&&a!==undefined?"name='"+a+"'":"",j!==null&&j!==undefined?"value='"+j+"'":"",d!==null&&d!==undefined?"color='"+d+"'":""].join(" ")}else{if(g){h=this.json2Params(g)}}c=["<set",h,"/>"];c=c.join(" ");if(c=="<set />"||(j===null||j===undefined)){}b.push(c)}this.setsXML=b.join("");return this.setsXML},createChartXML:function(b,c){c=c||this.setsXML;var a=["<graph","caption='"+(this.caption||"")+"'","subCaption='"+(this.subCaption||"")+"'","outCnvBaseFontSize='12'","animation='0'"];a.push(">"+c+"</graph>");this.chartXML=a.join(" ");return this.chartXML},updateChart:function(a,b){a=a||this.container;b=b||this.chartXML;window.updateChartXML&&(window.updateChartXML(a,b))},generateChart:function(a,b){this.data=b||this.data;this.createSetsXML();this.createChartXML();a=a||this.container;this.chart.setDataXML(this.chartXML);this.chart.render(a)}});Sigma.Chart.SWFMapping={column2D:"FCF_Column2D.swf",pie3D:"FCF_Pie3D.swf"};Sigma.AjaxDefault={paramName:"_gt_json"};Sigma.Ajax=Sigma.$class({properties:function(){return{method:"post",jsonParamName:Sigma.AjaxDefault.paramName,async:true,urlEncoded:true,encoding:null,mimeType:null,beforeSend:Sigma.$empty,onComplete:Sigma.$empty,onSuccess:Sigma.$empty,onFailure:Sigma.$empty,onCancel:Sigma.$empty,xhr:"",url:"",data:"",paramType:"jsonString",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"text/javascript, text/html, application/xml,application/json, text/xml, */*"},autoCancel:false,evalScripts:false,evalResponse:false,responseContentType:"",dataUrl:false,queryParameters:null}},setQueryParameters:function(a){this.queryParameters=a},initialize:function(b){b=b||{};if(Sigma.$type(b,"string")){b={url:b}}if(!(this.xhr=this.getXHR())){return}var a=Sigma.$extend(this.headers,b.headers);Sigma.$extend(this,b);if(this.mimeType){a["X-Response-MimeType"]=this.mimeType}this.headers=a},send:function(l){this.running=true;if(Sigma.$type(l,"string")){l={data:l}}l=Sigma.$extend({data:this.data,url:this.url,method:this.method},l);var f=l.data,b=l.url,a=String(l.method).toLowerCase();if(Sigma.$invoke(this,"beforeSend",[this.xhr,f])===false){return this}if(this.urlEncoded&&a=="post"){var c=(this.encoding)?"; charset="+this.encoding:"";this.setHeader("Content-type","application/x-www-form-urlencoded"+c)}switch(Sigma.$type(f)){case"object":if(this.paramType=="jsonString"){var d=Sigma.$json(f);f={};f[this.jsonParamName]=d}f=Sigma.toQueryString(f);break;default:}var k;if(this.queryParameters&&Sigma.$type(this.queryParameters,"object")){k=Sigma.toQueryString(this.queryParameters)}else{if(Sigma.$type(this.queryParameters,"string")){k=this.queryParameters}}if(k&&Sigma.$type(f,"string")){f=f+"&"+k}if(a=="post"){var i=b.indexOf("?");if(i>=0){f=b.substring(i+1)+"&"+f;b=b.substring(0,i)}}else{if(f&&(a=="get"||this.dataUrl)){b=b+(b.indexOf("?")>=0?"&":"?")+f;f=null}}var g=this;this.xhr.open(a.toUpperCase(),b,this.async);this.xhr.onreadystatechange=function(){return g.onStateChange.apply(g,arguments)};for(var j in this.headers){try{this.xhr.setRequestHeader(j,this.headers[j])}catch(h){}}this.xhr.send(f);if(!this.async){this.onStateChange()}return this},onStateChange:function(){if(this.xhr.readyState!=4||!this.running){return}this.running=false;this.status=0;try{this.status=this.xhr.status}catch(a){}this.onComplete();if(this.isSuccess()){this._onSuccess()}else{this._onFailure()}this.xhr.onreadystatechange=Sigma.$empty},isScript:function(){return(/(ecma|java)script/).test(this.getHeader("Content-type"))},isSuccess:function(){var a=this.xhr.status;return((a>=200)&&(a<300))},_onSuccess:function(){this.response={text:this.xhr.responseText,xml:this.xhr.responseXML};this.onSuccess(this.response)},_onFailure:function(a){this.onFailure(this.xhr,a)},setHeader:function(a,b){this.headers[a]=b;return this},getHeader:function(a){try{return this.xhr.getResponseHeader(a)}catch(b){return null}},getXHR:function(){return(window.XMLHttpRequest)?new XMLHttpRequest():((window.ActiveXObject)?new ActiveXObject("Microsoft.XMLHTTP"):false)},cancel:function(){if(!this.running){return this}this.running=false;this.xhr.abort();this.xhr.onreadystatechange=Sigma.$empty;this.xhr=this.getXHR();this.onCancel();return this}});Sigma.JSON={encode:function(e,c,d){var a;var b=d?"\n":"";switch(Sigma.$type(e)){case"string":return'"'+e.replace(/[\x00-\x1f\\"]/g,Sigma.JSON.$replaceChars)+'"';case"array":a=[];Sigma.$each(e,function(h,f){var g=Sigma.JSON.encode(h,c,d);if(g||g===0){a.push(g)}});return"["+b+(d?a.join(","+b):a)+"]"+b;case"object":if(e===null){return"null"}a=[];Sigma.$each(e,function(h,g){if(!c||g.indexOf(c)!==0){var f=Sigma.JSON.encode(h,c,d);if(f){a.push(Sigma.JSON.encode(g,c,d)+":"+f)}}},null,c);return"{"+b+(d?a.join(","+b):a)+b+"}"+b;case"number":case"boolean":return String(e)}return null},decode:function(string,secure){if(!Sigma.$type(string,"string")||!string.length){return null}if(secure&&!(/^[,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]*$/).test(string.replace(/\\./g,"@").replace(/"[^"\\\n\r]*"/g,""))){return null}return eval("("+string+")")},$specialChars:{"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},$replaceChars:function(a){return Sigma.JSON.$specialChars[a]||"\\u00"+Math.floor(a.charCodeAt()/16).toString(16)+(a.charCodeAt()%16).toString(16)}};Sigma.ColumnDefault={CLASS_PREFIX:".",destroyList:["sortIcon","hdTool","menuButton","separator","frozenSortIcon","frozenHdTool","frozenHeadCell","headCell","firstCell"],id:0,fieldName:null,width:120,minWidth:45,header:null,styleClass:null,align:"left",headAlign:"left",emptyText:"",sortable:true,resizable:true,moveable:true,editable:true,hideable:true,freezeable:true,groupable:true,filterable:true,printable:true,exportable:true,sortOrder:null,enableDefaultSort:false,hidden:false,frozen:false,toolTip:false,beforEdit:null,afterEdit:null,renderer:function(f,a,b,c,d,e){return f!==null&&f!==undefined?f:b.emptyText},hdRenderer:function(b,a){return b},editor:null,fieldIndex:0,gridId:null,filterField:null,newValue:null,cellAttributes:"",getSortValue:null,sortFn:null,format:null,syncRefresh:true,expression:null,isExpend:false,initialize:function(b,a){var c=this;if(Sigma.$type(b,"string")){this.id=b}else{Sigma.$extend(this,b)}this.id=this.id||encodeURIComponent(this.header);this.header=this.header||this.id;this.fieldName=this.fieldName||this.fieldIndex||this.id;this.fieldIndex=this.fieldIndex||this.fieldName||this.id;this.CLASS_PREFIX=".gt-grid "+this.CLASS_PREFIX},destroy:function(){if(this.editor&&this.editor.destroy){this.editor.destroy()}this.editor=null;Sigma.$each(this.destroyList,function(a,b){Sigma.U.removeNode(this[a]);this[a]=null})},getColumnIndex:function(){return this.colIndex},setWidth:function(b){var a=this.grid;b=b<this.minWidth?this.minWidth:b;this.width=b+"px";Sigma.U.CSS.updateRule(this.CLASS_PREFIX+this.styleClass,"width",(b+a.cellWidthFix)+"px");Sigma.U.CSS.updateRule(this.CLASS_PREFIX+this.innerStyleClass,"width",(b+a.innerWidthFix)+"px")},setHeader:function(c){this.header=c;var b=this.headCell.getElementsByTagName("div")[0];if(b){var a=b.getElementsByTagName("span")[0]||b;a.innerHTML=c}},rerender:function(){if(!this.grid.renderHiddenColumn){this.grid.kickHeader();this.grid.refresh()}},hide:function(){if(this.frozen){return false}Sigma.U.CSS.updateRule(this.CLASS_PREFIX+this.styleClass,"display","none");this.hidden=true;this.rerender()},show:function(){if(this.frozen){return false}Sigma.U.CSS.updateRule(this.CLASS_PREFIX+this.styleClass,"display","");this.hidden=false;this.rerender()},toggle:function(){return this.hidden?this.show():this.hide()},group:function(a){if(a!==false){a=true}this.grouped=a;this.grid.refresh()},ungroup:function(){this.group(false)},freezeCell:function(h,f,e,a,g,i,b,c){if(!b.hasIndexColumn){e=h.cloneNode(false);e.id="";e.appendChild(i.cloneNode(true));f.appendChild(e)}var d=h.cells[g].cloneNode(true);e.appendChild(d);if(c&&a===0){this.frozenHeadCell=d;this.frozenSortIcon=Sigma.Grid.getSortIcon(this,this.frozenHeadCell);this.frozenHdTool=Sigma.Grid.getHdTool(this,this.frozenHeadCell);if(!Sigma.isIE){Sigma.Grid.initColumnEvent(b,this,this.frozenHeadCell,this.frozenSortIcon)}}},freeze:function(c){var a=this.grid;var f=this.getColumnIndex();if(!c&&f<a.frozenColumnList.length){return false}var g=a.headTable.tBodies[0].rows;var h=a.freezeHeadTable.tBodies[0].rows;var e,j,d;var b=10;if(!a.hasIndexColumn){e=Sigma.T_G.freezeHeadCell(a,b,null);j=Sigma.T_G.freezeBodyCell(a,b,null)}for(d=0;d<g.length;d++){this.freezeCell(g[d],a.freezeHeadTable.tBodies[0],h[d],d,f,e,a,true)}if(a.rowNum<1){}a.isEmptyfreezeZone=false;if(a.overRow){a.overRow.className=a.overRow.className.replace(" gt-row-over","")}g=a.getAllRows();h=a.freezeBodyTable.tBodies[0].rows;for(d=0;d<g.length;d++){this.freezeCell(g[d],a.freezeBodyTable.tBodies[0],h[d],d,f,j,a)}if(!c){a.moveColumn(f,a.frozenColumnList.length);a.frozenColumnList.push(this.id)}this.frozen=true;a.freezeHeadDiv.style.display=a.freezeBodyDiv.style.display="block";a.freezeHeadDiv.style.height=a.headDiv.offsetHeight+"px";a.freezeBodyDiv.style.height=a.bodyDiv.clientHeight+"px";if(!a.hasIndexColumn){a.freezeHeadDiv.style.left=a.freezeBodyDiv.style.left=0-(b+a.cellWidthFix)+a.freezeFixW+"px"}a.hasIndexColumn=true;a.syncScroll();Sigma.U.removeNode(e,j)},unfreezeCell:function(c,b){for(var a=0;a<c.length;a++){Sigma.U.removeNodeTree(c[a].cells[b])}},unfreeze:function(){var a=this.grid;var b=this.getColumnIndex();if(!a.frozenColumnList||b>=a.frozenColumnList.length){return false}this.frozenHeadCell=this.frozenHdTool=this.frozenSortIcon=null;a.moveColumn(b,a.frozenColumnList.length-1);a.frozenColumnList.splice(b,1);var c=a.freezeHeadTable.tBodies[0].rows;this.unfreezeCell(c,b+1);if(a.rowNum<1){}c=a.freezeBodyTable.tBodies[0].rows;this.unfreezeCell(c,b+1);this.frozen=false;if(a.frozenColumnList.length<1){if(!a.showIndexColumn){a.freezeHeadDiv.style.display=a.freezeBodyDiv.style.display="none"}}a.syncScroll()}};Sigma.Column=Sigma.$class(Sigma.ColumnDefault);Sigma.Const.DataSet={KEY:"__gt_ds_key__",INDEX:"__gt_ds_index__",ROW_KEY:"__gt_row_key__",NOT_VAILD:"__gt_no_valid__",SN_FIELD:"__gt_sn__",SORT_VALUE:"__gt_sort_value__",SORT_S:"__gt_"};Sigma.DataSetDefault={SEQUENCE:0,uniqueField:Sigma.Const.DataSet.SN_FIELD,recordType:"object",recordXpath:null,dataXML:null,currentBegin:0,cursor:0,startRecordNo:0,cacheData:false,cacheModifiedData:true,modified:false,properties:function(){return{fields:[],fieldsName:[],fieldsMap:{},fieldsInfo:{},data:null,dataProxy:[],dataProxyBak:null,additional:[],sortInfo:[],queryInfo:[],reocrdIndex:{},updatedRecords:{},updatedRecordsBak:{},updatedFields:{},insertedRecords:{},deletedRecords:{},onRecordInsert:Sigma.$empty,onRecordUpdate:Sigma.$empty}},initialize:function(a){Sigma.$extend(this,a);this.recordType=this.recordType||"object";this.fields&&this.setFields(this.fields);this.data&&this.setData(this.data);this.unfieldIdx=this.uniqueField},initValues:Sigma.$empty,isEqualRecord:function(b,a){for(var c in this.fieldsInfo){if(b[c]!==a[c]){return false}}return true},clean:function(a){if(!this.cacheData||a===true){this.data=null;this.currentBegin=0;this.dataProxy=[]}this.cleanModifiedData()},cleanModifiedData:function(a){if(!this.cacheModifiedData||a){this.updatedRecords={};this.updatedRecordsBak={};this.updatedFields={};this.insertedRecords={};this.deletedRecords={}}},setData:function(a){if(!a){return false}this.clean();return this.appendData(a)},setFields:function(b){this.fields=b;this.fieldsName=[];var e=null;for(var c=0,a=this.fields.length;c<a;c++){var d=this.fields[c]||{};if(Sigma.$type(d,"string")){d={name:d}}d.name=d.name||String(c);d.type=d.type||"string";d.index=d.index||(this.getRecordType()=="array"?c:d.name);if(d.initValue){e=e||{};e[d.index]=d.initValue}this.fieldsMap[d.name]=d;this.fieldsInfo[d.index]=d;this.fieldsName[c]=d.name}if(e){this.initValues=(function(f){return function(h,i,j){for(var g in f){h[g]=f[g](h,i,j)}}})(e)}else{this.initValues=Sigma.$empty}},appendData:function(e){if(!e){return false}this.data=this.data||[];var f=this;var c=Sigma.Const.DataSet.SN_FIELD;for(var d=0,a=e.length;d<a;d++){var b=e[d];b[c]=b[c]||this.SEQUENCE++;this.data.push(b);this.dataProxy.push(this.currentBegin++);this.initValues(b,d,this)}return true},getDataProxySize:function(){return this.dataProxy.length},resetDataProxy:function(b){this.dataProxy=[];b=b||this.getSize();for(var a=0;a<b;a++){this.dataProxy[a]=a}},loadData:function(a){if(a){return this.setData(a.load())}else{}},setRecordType:function(a){if(a&&this.recordType!=a){this.recordType=a;this.setFields(this.fields)}},getRecord:function(a){return this.data?this.data[this.dataProxy[a]]:null},getDataRecord:function(a){return this.dataset.data[a]},setValueByName:function(a,d,c){var b=this.fieldsMap[d].index;if(Sigma.$type(a,"number")){a=this.getRecord(a)}a[b]=c},getValueByName:function(a,c){var b=this.fieldsMap[c].index;if(Sigma.$type(a,"number")){a=this.getRecord(a)}return a[b]},getFields:function(){},getRecordType:function(b,a){this.recordType=b||this.recordType;if(!Sigma.$type(this.recordType,"string")&&(this.data&&this.getSize()>0)){a=this.data[0];if(Sigma.$type(a,"array")){this.recordType="array"}else{this.recordType="object"}}return this.recordType},filterCheck:{equal:function(b,a){return b==a},notEqual:function(b,a){return b!=a},less:function(b,a){return b<a},great:function(b,a){return b>a},lessEqual:function(b,a){return b<=a},greatEqual:function(b,a){return b>=a},like:function(b,a){return(""+b).indexOf(a+"")>=0},startWith:function(b,a){return(""+b).indexOf(a+"")===0},endWith:function(b,a){b=b+"";a=a+"";return b.indexOf(a)==b.length-a.length}},filterData:function(c){var b=this;var a=[];c=[].concat(c);Sigma.$each(this.data,function(k,m){var e=true;for(var g=0,f=c.length;g<f;g++){var l=b.fieldsMap[c[g].fieldName].index;var h=c[g].value;var d=c[g].logic;var n=k[l];e=b.filterCheck[d](n,h);if(!e){break}}if(e){a.push(m)}else{}});return a},insertRecord:function(a){var b=(this.SEQUENCE++);a[Sigma.Const.DataSet.SN_FIELD]=b;this.insertedRecords[b]=a;Sigma.$invoke(this,"onRecordInsert",[a]);this.modified=true},updateRecord:function(a,h,f){if(Sigma.$type(a,"number")){a=this.data[a]}var g=a[Sigma.Const.DataSet.SN_FIELD];var d=a[this.unfieldIdx];var c=this.fieldsMap[h].type;var b=this.fieldsMap[h].index;var e;if(!this.insertedRecords[g]){this.updatedRecordsBak[d]=this.updatedRecordsBak[d]||{};this.updatedRecordsBak[d][b]=a[b];this.updatedRecordsBak[d][this.unfieldIdx]=d;this.updatedRecords[d]=a}if(this.insertedRecords[g]||Sigma.$invoke(this,"onRecordUpdate",[a,h,f])!==false){if(c=="int"){f=parseInt(f);f=isNaN(f)?"":f}else{if(c=="float"){f=parseFloat(f);f=isNaN(f)?"":f}else{f=Sigma.$chk(f)?String(f):""}}this.updatedFields[d]=this.updatedFields[d]||{};this.updatedFields[d][b]=f;this.updatedFields[d][this.unfieldIdx]=d;a[b]=f;this.modified=true}},undeleteRecord:function(e){var c=-1,a,b;if(Sigma.$type(e,"number")){c=e;if(c>=0){b=this.dataProxy[c];a=this.data[b]}}else{if(e&&(Sigma.$type(e,"object")||Sigma.$type(e,"array"))){a=e}}if(a){var f=a[Sigma.Const.DataSet.SN_FIELD];var d=a[this.unfieldIdx];this.deletedRecords[d]=null;delete this.deletedRecords[d]}},deleteRecord:function(e){var c=-1,a,b;if(Sigma.$type(e,"number")){c=e;if(c>=0){b=this.dataProxy[c];a=this.data[b]}}else{if(e&&(Sigma.$type(e,"object")||Sigma.$type(e,"array"))){a=e}}if(a){var f=a[Sigma.Const.DataSet.SN_FIELD];var d=a[this.unfieldIdx];if(this.insertedRecords[f]){delete this.insertedRecords[f]}else{if(this.updatedRecords[d]){delete this.updatedRecords[d];delete this.updatedRecordsBak[d]}this.deletedRecords[d]=a;this.modified=true}}},addUniqueKey:function(a){},isInsertedRecord:function(a){return a&&this.insertedRecords[a[Sigma.Const.DataSet.SN_FIELD]]==a},isDeletedRecord:function(a){return a&&this.deletedRecords[a[this.unfieldIdx]]==a},isUpdatedRecord:function(a){return a&&this.updatedRecords[a[this.unfieldIdx]]==a},sortFunction:null,negative:function(a){return function(d,c){return 0-a(d,c)}},sort:function(j){var d=[].concat(j);var l=[];for(var b=0;b<d.length;b++){var m=d[b];if(m){var f,e,h;var a=m.sortOrder.indexOf("def")===0;if(!m.sortOrder||a){h=Sigma.Const.DataSet.SN_FIELD;e="int"}else{f=this.fieldsMap[m.fieldName];if(f){h=f.index;e=f.type}}l.push(!a&&m.sortFn?m.sortFn:this.getSortFuns(h,m.sortOrder,e,m.getSortValue))}}var g=this;var c=l.length;var k=function(q,o){var r=g.data[q],p=g.data[o];for(var s=0;s<c;s++){var n=l[s](r,p,d[s].sortOrder);if(n!==0){return n}}return 0};this.dataProxy.sort(k)},getSortFuns:function(i,b,e,c){var g=this;var a=Sigma.Const.DataSet.SORT_VALUE;var f={};var h=this.sortFunction;if(!h){var d=c&&b.indexOf("def")!==0?function(k){var l=k[i];var j=c(l,k);f[k[Sigma.Const.DataSet.SN_FIELD]]=j;return j}:function(k){var l=k[i];var j=Sigma.U.convert(l,e);f[k[Sigma.Const.DataSet.SN_FIELD]]=j;return j};h=b=="desc"?function(k,j){var m=f[k]||d(k);var l=f[j]||d(j);return m<l?1:(m>l?-1:0)}:function(k,j){var m=f[k]||d(k);var l=f[j]||d(j);return m<l?-1:(m>l?1:0)}}return h},query:function(d,c,b,a){},getSize:function(){return !this.data?-1:this.data.length},getFieldsNum:function(){return this.fields.length},sum:function(a){},avg:function(a){}};Sigma.DataSet=Sigma.$class(Sigma.DataSetDefault);Sigma.DialogDefault={hasCloseButton:true,autoRerender:true,title:null,body:null,buttonZone:null,headHeight:20,hidden:false,initialize:function(a){if(a){Sigma.$extend(this,a)}this.domId=(this.gridId?this.gridId+"_":"")+this.id;this.buttonLayout=this.buttonLayout||"h";this.dialogId=this.id;Sigma.WidgetCache[this.id]=this},destroy:function(){this.container=null;Sigma.U.removeNode(this.bodyDiv);this.bodyDiv=null;Sigma.U.removeNode(this.dom);this.dom=null;Sigma.WidgetCache[this.id]=null;delete Sigma.WidgetCache[this.id]},titleRender:function(a){this.title=a||this.title;return this.title},show:function(){var a=Sigma.$grid(this.gridId);a.closeGridMenu();if(Sigma.$invoke(this,"beforeShow",[a])!==false){this.locked=true;a.showMask();this.autoRerender&&this.render(a.gridMask);a.gridMask.appendChild(this.dom);if(this.width/1&&this.width>0){this.dom.style.marginLeft=(0-this.width/2)+"px"}this.dom.style.marginTop="0px";this.dom.style.top="25px";this.dom.style.display="block";a.activeDialog=this;this.hidden=false;Sigma.$invoke(this,"afterShow",[a])}},hide:function(){var a=Sigma.$grid(this.gridId);if(Sigma.$invoke(this,"beforeHide",[a])!==false){this.locked=false;a.hideMask();if(this.dom){this.dom.style.display="none";a.gridEditorCache.appendChild(this.dom)}a.activeDialog=null;this.hidden=true;Sigma.$invoke(this,"afterHide",[a])}},close:function(){var a=Sigma.$grid(this.gridId);this.hide()},confirm:function(){var a=Sigma.$grid(this.gridId);if(a.activeEditor==this){this.locked=false;a.endEdit();a.activeEditor=this}},render:function(a){this.container=a||this.container;if(!this.rendered){this.dom=this.dom||Sigma.$e("div",{className:"gt-grid-dialog"});this.dom.id=this.domId+"_dialog";this.container=this.container||Sigma.doc.body;this.container.appendChild(this.dom);this.dom.innerHTML=Sigma.T_D.create(this);this.titleDiv=Sigma.$(this.domId+"_dialog_title");this.bodyDiv=Sigma.$(this.domId+"_dialog_body");if(this.height){this.bodyDiv.style.height=this.height-(this.headHeight||0)+"px"}this.setBody();this.setButtons();this.setTitle();Sigma.$invoke(this,"afterRender",[this])}this.setSize();this.setPosition();if(Sigma.$type(this.valueDom,"function")){this.valueDom=this.valueDom()}this.valueDom=Sigma.$(this.valueDom);this.rendered=true},setBody:function(a){var b=Sigma.$grid(this.gridId);this.body=a||this.body;this.bodyDiv.innerHTML="";if(Sigma.$type(this.body,"function")){this.body=this.body(b)}if(!this.body){}else{if(Sigma.$type(this.body,"string")){this.bodyDiv.innerHTML=this.body}else{this.bodyDiv.appendChild(this.body)}}},setButtons:function(c){this.buttons=c||this.buttons;if(!this.buttons){return}c=[].concat(this.buttons);if(c.length>0){this.buttonZone=this.buttonZone||Sigma.$e("div",{className:"gt-dialog-buttonzone-"+this.buttonLayout,id:this.domId+"_div"});if(this.buttonLayout=="h"){this.buttonZone.style.width=this.width-12+"px"}for(var b=0;b<c.length;b++){var a=null;if(c[b].breakline){a=Sigma.$e("br")}else{if(c[b].html){a=Sigma.$e("span",{innerHTML:c[b].html})}else{a=Sigma.$e("button",{id:this.domId+"_"+c[b].id,className:"gt-input-button",innerHTML:c[b].text});Sigma.U.addEvent(a,"click",c[b].onclick)}}this.buttonZone.appendChild(a)}}this.bodyDiv.appendChild(this.buttonZone)},setTitle:function(a){this.titleDiv.innerHTML=this.titleRender(a)}};Sigma.Dialog=Sigma.Widget.extend(Sigma.DialogDefault);Sigma.createColumnTable=function(e,g){e=Sigma.$grid(e);g=g||{};g.checkType=g.checkType||"checkbox";g.canCheck=g.canCheck||function(h){return !h.hidden};function b(h,j){var i=h.canCheck===true||h.canCheck(j)!==false;return'<input type="'+h.checkType+'" name="'+h.name+'" value="'+h.value(j)+'" class="gt-f-check" '+(h.checked(j)?' checked="checked" ':"")+(!i?' disabled="disabled" ':"")+" />"}function c(h){return h.checkType=="checkbox"?'<input type="checkbox" name="'+h.name+'" class="gt-f-totalcheck" />':'<input type="radio" name="'+h.name+'" />'}var a=e.columnList;var f=['<table class="gt-table" style="margin-left:0px" cellSpacing="0"  cellPadding="0" border="0" >','<col style="width:25px" /><col style="width:105px" />',"<thead>",Sigma.T_G.rowStart(e,0),Sigma.T_G.cellStartHTML,c(g),Sigma.T_G.cellEndHTML,Sigma.T_G.cellStartHTML,e.getMsg("COLUMNS_HEADER"),Sigma.T_G.cellEndHTML,Sigma.T_G.rowEndHTML,"</thead>","<tbody>"];for(var d=0;d<a.length;d++){f.push([Sigma.T_G.rowStart(e,d),Sigma.T_G.cellStartHTML,b(g,a[d]),Sigma.T_G.cellEndHTML,Sigma.T_G.cellStartHTML,a[d].header||a[d].title,Sigma.T_G.cellEndHTML,Sigma.T_G.rowEndHTML].join(""))}f.push("</tbody></table>");return f.join("\n")};Sigma.checkChecked=function(b){b=Sigma.$grid(b);var c=b.chkAll;var k=Sigma.U.getParentByTagName("td",c);var a=Sigma.U.getCellIndex(k);var l=b.getAllRows();var e=0;for(var f=0,d=l.length;f<d;f++){var g=l[f].cells[a];if(g){var h=g.getElementsByTagName("input")[0];if(h&&b.checkedRows[h.value]){h.checked=true;e++}}}c.checked=e==l.length};Sigma.createColumnDialog=function(d,f){var e=d+"ColCheck";var c=f.gridId;var i=c+"_"+d+"ColDialog";var a=Sigma.$grid(c);var b=function(){var p=Sigma.$(i+"_div");var q=(Sigma.U.getTagName(p)=="TABLE")?p:p.getElementsByTagName("table")[0];var m=q.tBodies[0];var j=m.getElementsByTagName("input");var k=Sigma.U.getCheckboxState(j,e);var o=[],n;for(n=0;n<a.columnList.length;n++){o.push(a.columnList[n].id)}for(n=0;n<o.length;n++){var l=a.columnMap[o[n]];if(k[l.id]){l[f.checkFn]()}else{l[f.uncheckFn]()}}if(f.autoClose!==false){a._onResize();Sigma.WidgetCache[i].close()}};var h=function(){Sigma.WidgetCache[i].close()};var g=new Sigma.Dialog({id:i,gridId:c,title:f.title,width:260,height:220,buttonLayout:"v",body:['<div id="'+i+'_div" onclick="Sigma.clickHandler.onTotalCheck(event)" class="gt-column-dialog" >',"</div>"].join(""),buttons:[{text:a.getMsg("TEXT_OK"),onclick:b},{text:a.getMsg("TEXT_CLOSE"),onclick:h}],afterShow:function(){var j=Sigma.$grid(this.gridId);var k=Sigma.createColumnTable(this.gridId,{type:"checkbox",name:e,value:function(l){return l.id},checked:f.checkValid,checkType:f.checkType,canCheck:f.canCheck});Sigma.$(this.id+"_div").innerHTML=k}});return g};Sigma.createFilterDialog=function(h){var d=h.gridId;var a=Sigma.$grid(d);var l=d+"_filterDialog";a.justShowFiltered=h.justShowFiltered===true?true:(h.justShowFiltered===false?false:a.justShowFiltered);a.afterFilter=h.afterFilter||a.afterFilter;var b=function(){if(a._noFilter){g();a._noFilter=false}var o=Sigma.$(l+"_column_select");if(o&&o.options.length>0){var p=o.value;var n=o.options[o.selectedIndex].text;Sigma.$(l+"_div").appendChild(Sigma.createFilterItem(a,p,n))}};var g=function(){Sigma.$(l+"_div").innerHTML=""};var c=function(){var v=Sigma.$(l+"_div");var q=[];var u=v.childNodes;for(var p=0;p<u.length;p++){if(Sigma.U.getTagName(u[p])=="DIV"&&u[p].className=="gt-filter-item"){var o=u[p].childNodes[1];var w=u[p].childNodes[2];var r=u[p].childNodes[3].firstChild;var t=Sigma.U.getValue(o);var n=a.columnMap[t];if(n&&n.fieldName){q.push({columnId:t,fieldName:n.fieldName,logic:Sigma.U.getValue(w),value:Sigma.U.getValue(r)})}}}if(q.length>0){var s=a.applyFilter(q)}else{a.applyFilter([])}if(h.autoClose!==false){a._onResize();Sigma.WidgetCache[l].close()}};var k=function(){Sigma.WidgetCache[l].close()};var e=430,m=220;var j=e-(Sigma.isBoxModel?16:18),f=m-(Sigma.isBoxModel?93:95);var i=new Sigma.Dialog({id:l,gridId:d,title:h.title,width:e,height:m,buttonLayout:"h",body:['<div id="'+l+'_div" class="gt-filter-dialog" style="width:'+j+"px;height:"+f+'px;" onclick="Sigma.clickHandler.onFilterItem(event)" >',"</div>"].join(""),buttons:[{html:Sigma.createColumnSelect(a,l+"_column_select")},{text:a.getMsg("TEXT_ADD_FILTER"),onclick:b},{text:a.getMsg("TEXT_CLEAR_FILTER"),onclick:g},{breakline:true},{text:a.getMsg("TEXT_OK"),onclick:c},{text:a.getMsg("TEXT_CLOSE"),onclick:k}],afterShow:function(){var n=Sigma.$grid(this.gridId);var t=n.filterInfo||[];g();for(var q=0;q<t.length;q++){var v=t[q].columnId;var p=n.getColumn(v);var r=(p.header||p.title);var u=Sigma.createFilterItem(n,v,r);var o=u.childNodes[1];var w=u.childNodes[2];var s=u.childNodes[3].firstChild;Sigma.U.setValue(o,v);Sigma.U.setValue(w,t[q].logic);Sigma.U.setValue(s,t[q].value);Sigma.$(this.id+"_div").appendChild(u)}if(t.length<1){Sigma.$(this.id+"_div").innerHTML='<div style="color:#999999;margin:10px;">'+n.getMsg("DIAG_NO_FILTER")+"</div>";n._noFilter=true}}});return i};Sigma.createColumnSelect=function(c,e){c=Sigma.$grid(c);var d=["<select"+(e?(' id="'+e+'" '):" ")+' class="gt-input-select">'];for(var b=0;b<c.columnList.length;b++){var a=c.columnList[b];if(a&&a.filterable!==false){d.push('<option value="'+a.id+'" >'+(a.header||a.title)+"</option>")}}d.push("</select>");return d.join("")};Sigma.createFilterField=function(a,d){a=Sigma.$grid(a);var b=a.getColumn(d),c;if(typeof b.filterField=="function"){c=b.filterField(b)}else{if(b.filterField){c=b.filterField}}c=c||'<input type="text" class="gt-input-text gt-filter-field-text" value="" />';return'<div class="gt-filter-field-box">'+c+"</div>"};Sigma.createFilterItem=function(c,g,b){c=Sigma.$grid(c);var f=Sigma.$e("div",{className:"gt-filter-item"});var e='<input type="text" readonly="readonly" class="gt-input-text gt-filter-col-text" value="'+b+'" />';e+='<input type="hidden"  value="'+g+'" />';var a=Sigma.createFilterField(c,g);var d='<button class="gt-input-button gt-filter-del" >'+c.getMsg("TEXT_DEL")+'</button><button class="gt-input-button gt-filter-up" >'+c.getMsg("TEXT_UP")+'</button><button class="gt-input-button gt-filter-down" >'+c.getMsg("TEXT_DOWN")+"</button>";f.innerHTML=e+Sigma.T_D.filterCondSelect+a+d;return f};Sigma.clickHandler={currentElement:null,onFilterItem:function(a){a=a||window.event;var f=Sigma.U.getEventTarget(a);var g=Sigma.U.getParentByTagName("table",null,a,10);if(Sigma.U.getTagName(f)=="BUTTON"){var c=" "+f.className;var e=f.parentNode;if(c.indexOf(" gt-filter-del")>=0){Sigma.U.removeNode(e)}else{if(c.indexOf(" gt-filter-up")>=0){var b=e.previousSibling;if(b){e.parentNode.insertBefore(e,b)}}else{if(c.indexOf(" gt-filter-down")>=0){var d=e.nextSibling;if(d){e.parentNode.insertBefore(d,e)}}}}}},onTotalCheck:function(b){b=b||window.event;var f=Sigma.U.getEventTarget(b);var h=Sigma.U.getParentByTagName("table",null,b,10);if(!f||(f.type!="checkbox"&&f.type!="radio")){return}if(Sigma.U.hasClass(f,"gt-f-totalcheck")){var c=h.tBodies[0];var a=c.getElementsByTagName("input");for(var d=0;d<a.length;d++){if(a[d].name==f.name&&a[d].type==f.type){a[d].checked=f.checked}}}else{if(Sigma.U.hasClass(f,"gt-f-check")){var e=h.tHead;var g=e.getElementsByTagName("input")[0];if(g){g.checked=false}}}}};Sigma.EditorDefault={gridId:null,left:0,top:0,render:Sigma.$empty,validator:null,isFocus:Sigma.$empty,onKeyPress:Sigma.$empty,errMsg:null,isActive:null,valueDom:null,locked:false,initialize:function(a){if(a){Sigma.$extend(this,a)}this.validator=this.validator||this.defaultValidator;if(Sigma.$type(this.validRule,"string")){this.validRule=this.validRule.split(",")}if(this.required){this.validRule=["required"].concat(this.validRule)}this.dom=this.dom||Sigma.$e("div",{className:"gt-editor-container"});Sigma.U.addEvent(this.dom,"click",function(b){Sigma.U.stopEvent(b)});Sigma.U.addEvent(this.dom,"dblclick",function(b){Sigma.U.stopEvent(b)})},destroy:function(){this.container=null;Sigma.U.removeNode(this.valueDom);this.valueDom=null;Sigma.U.removeNode(this.dom);this.dom=null;Sigma.WidgetCache[this.id]=null;delete Sigma.WidgetCache[this.id]},setValue:function(g,a,f,c,d,e,b){Sigma.U.setValue(this.valueDom,g)},getValue:function(g,a,f,c,d,e,b){return Sigma.U.getValue(this.valueDom)},parseValue:function(g,a,f,c,d,e,b){return g},getDisplayValue:function(a){return a===undefined?this.getValue():a},defaultValidator:function(m,g,a,b,h){var j=[];var l=[].concat(h.validRule);for(var f=0;f<l.length;f++){var k=l[f];var e=[m];if(Sigma.$type(k,"array")&&k.length>0){k=k[0];e=e.concat(k.slice(1))}var n=Sigma.Validator.getValidator(k);var d=true;if(Sigma.$type(n,"function")){d=n.apply(n,e)}if(d!==true){var c=Sigma.Validator.getMessage(this.validRule[f])||String(d);j.push(c)}}if(!j||j.length<1){j=""}return j},doValid:function(e,a,d,c){if(!this.validRule&&!this.validator){return true}e=(e===undefined||e===null)?this.getValue():e;var b=this.validator(e,a,d,c,this);if(b===true||b===undefined||b===null||b===""){return true}return b},active:function(){Sigma.U.focus(this.valueDom)}};Sigma.Editor=Sigma.Widget.extend(Sigma.EditorDefault);Sigma.DialogEditor=Sigma.Editor.extend(Sigma.$extend({getDom:function(){if(!this.dom&&this.render){var a=Sigma.$grid(this.gridId);this.render(a.gridMask)}return this.dom}},Sigma.DialogDefault));Sigma.EditDialog=Sigma.DialogEditor;Sigma.Calendar=window.Calendar||{trigger:Sigma.$empty};Sigma.$extend(Sigma.Editor,{factroy:function(a,b){if(Sigma.$type(a,"function")){a=a(b)}if((a instanceof Sigma.DialogEditor)||(a instanceof Sigma.Dialog)){a.gridId=b.id;a.container=b.gridMask;return a}if(a instanceof Sigma.Editor){return a}a=Sigma.$type(a,"string")?{type:a}:a;return a&&Sigma.Editor.EDITORS[a.type]?Sigma.Editor.EDITORS[a.type](a):null},register:function(b,a){if(a instanceof Sigma.Editor){a=function(){return a}}Sigma.Editor.EDITORS[b]=a},EDITORS:{text:function(a){a=new Sigma.Editor(a);a.valueDom=Sigma.$e("input",{type:"text",value:a.defaultValue||"",className:"gt-editor-text"});a.dom.appendChild(a.valueDom);return a},textarea:function(a){a=new Sigma.Editor(a);a.valueDom=Sigma.$e("textarea",{style:{width:a.width||"100px",height:a.height||"50px"},value:a.defaultValue||"",className:"gt-editor-text"});a.dom.appendChild(a.valueDom);a.dom.style.width=a.valueDom.style.width;a.dom.style.height=a.valueDom.style.height;a.setSize=Sigma.$empty;return a},select:function(a){a=new Sigma.Editor(a);a.valueDom=Sigma.U.createSelect(a.options,null,{className:"gt-editor-text"});a.dom.appendChild(a.valueDom);a.getDisplayValue=function(c){c=c===undefined?this.getValue():c;for(var b=0;b<this.valueDom.options.length;b++){if(String(this.valueDom.options[b].value)===String(c)){return this.valueDom.options[b].text||this.valueDom.options[b].innerHTML}}return(this.defaultText||this.defaultText==="")?this.defaultText:null};return a},checkbox:function(a){a=new Sigma.Editor(a);a.valueDom=Sigma.U.createSelect(a.options,null,{});a.dom.appendChild(a.valueDom);return a},date:function(d){d=new Sigma.Editor(d);var a=Sigma.$e("input",{type:"text",value:d.defaultValue||"",className:"gt-editor-text",style:{width:"78px",styleFloat:"left"}});var c=Sigma.$e("input",{type:"button",value:d.defaultValue||"",className:"gt-editor-date",styleFloat:"left"});d.dom.style.overflow="hidden";d.dom.appendChild(a);d.dom.appendChild(c);d.setSize=function(f,g){this.width=f||this.width;this.height=g||this.height;if(this.width/1&&this.width>0){this.dom.style.width=(this.width-1)+"px"}if(this.height/1&&this.height>0){this.dom.style.height=(this.height-1)+"px"}this.dom.firstChild.style.width=(this.width-20)+"px"};var e=function(f){d.onClose&&d.onClose();f.hide()};var b=function(){var f=d.format||"%Y-%m-%d";f=Sigma.U.replaceAll(f,"yyyy","%Y");f=Sigma.U.replaceAll(f,"MM","%m");f=Sigma.U.replaceAll(f,"dd","%d");f=Sigma.U.replaceAll(f,"HH","%H");f=Sigma.U.replaceAll(f,"mm","%M");f=Sigma.U.replaceAll(f,"ss","%S");Sigma.Calendar.trigger({inputField:a,ifFormat:f,showsTime:true,button:"date_button",singleClick:true,onClose:e,step:1})};Sigma.U.addEvent(c,"click",b);d.valueDom=a;return d}}});if(!Sigma.Template){Sigma.Template={}}Sigma.$extend(Sigma.Template,{Grid:{main:function(a){var b=a.id;var c=[a.toolbarPosition=="top"||a.toolbarPosition=="t"?'<div id="'+b+'_toolBarBox" class="gt-toolbar-box gt-toolbar-box-top" ></div>':"",'<div id="'+b+'_viewport" class="gt-viewport'+(a.simpleScrollbar?" gt-simple-scrollbar":"")+'" >','<div id="'+b+'_headDiv" class="gt-head-div"><div class="gt-head-wrap" ></div>','<div id="'+b+'_columnMoveS" class="gt-column-moveflag"></div>','<div id="'+b+'_headerGhost" class="gt-head-ghost"></div>',"</div>",'<div id="'+b+'_bodyDiv" class="gt-body-div"></div>','<div id="'+b+'_freeze_headDiv" class="gt-freeze-div" ></div>','<div id="'+b+'_freeze_bodyDiv" class="gt-freeze-div" ></div>',"</div>",a.toolbarPosition=="bottom"||a.toolbarPosition=="b"?'<div id="'+b+'_toolBarBox" class="gt-toolbar-box" ></div>':"",'<div id="'+b+'_separateLine" class="gt-split-line"></div>','<div id="'+b+'_mask" class="gt-grid-mask" >','<div  id="'+b+'_waiting" class="gt-grid-waiting">','<div class="gt-grid-waiting-icon"></div><div class="gt-grid-waiting-text">'+a.getMsg("WAITING_MSG")+"</div>","</div>",'<div class="gt-grid-mask-bg">',"</div>","</div>"];return c.join("\n")},formIFrame:function(a){var b=a.id;var c=['<div class="gt-hidden" >','<form id="'+b+'_export_form" target="'+b+'_export_iframe" style="width:0px;height:0px;margin:0px;padding:0xp" method="post" width="0" height="0" >','<input type="hidden" id="'+b+'_export_filename" name="exportFileName"  value="" />','<input type="hidden" id="'+b+'_export_exporttype" name="exportType" value="" />','<textarea id="'+b+'_export_form_textarea" name="" style="width:0px;height:0px;display:none;" ></textarea>',"</form>",'<iframe id="'+b+'_export_iframe"  name="'+b+'_export_iframe" scrolling="no" style="width:0px;height:0px;" width="0" height="0" border="0" frameborder="0" src="javascript:false" >',"</iframe>","</div>"];return c.join("\n")},createHeaderCell:function(c,b,d){var a=Sigma.$e("td",{className:b.styleClass,columnId:b.id});var e=b.hdRenderer(b.header,b,c);b.title=b.title||b.header||"";e=(!e||Sigma.U.trim(e)==="")?"&#160;":e;if(d){a.style.height="0px"}a.innerHTML=['<div class="gt-inner'+(b.headAlign?" gt-inner-"+b.headAlign:"")+'" ',d?'style="padding-top:0px;padding-bottom:0px;height:1px;" ':"",'unselectable="on" title="'+b.title+'" >',"<span>",e,"</span>",d?"":Sigma.T_G.hdToolHTML,"</div>"].join("");return a},hdToolHTML:'<div class="gt-hd-tool" ><span class="gt-hd-icon"></span><span class="gt-hd-button"></span><span class="gt-hd-split"></span></div>',bodyTableStart:function(b,a){return["<table ",b?'id="'+b+'" ':"",'class="gt-table" cellspacing="0"  cellpadding="0" border="0" >',a===false?"":"<tbody>"].join("")},tableStartHTML:'<table class="gt-table" style="margin-left:0px" cellspacing="0"  cellpadding="0" border="0" ><tbody>',tableEndHTML:"</tbody></table>",rowStart:function(a,b,c){return Sigma.T_G.rowStartS(a,b)+">\n"},rowStartS:function(a,c,b){return['<tr class="gt-row',(c%2===0?a.evenRowCss:""),'" ',Sigma.Const.DataSet.INDEX,'="',c,'" ',b].join("")},rowEndHTML:"</tr>\n",innerStart:function(a){return['<div class="gt-inner '+(a.align?" gt-inner-"+a.align+" ":"")+"",'" >'].join("")},cellStartHTML:'<td ><div class="gt-inner" >',cellEndHTML:"</div></td>",cell:function(a,c,b){return["<td ",b||a.cellAttributes,' class="'+a.styleClass+'" >',a.innerStartHTML,c,"</div></td>"].join("")},getColStyleClass:function(a,b){return(Sigma.Const.Grid.COL_T_CLASSNAME+a.id+"-"+b).toLowerCase()},freezeBodyCell:function(d,f,g,e){var a=f+d.cellWidthFix;var h=f+d.innerWidthFix;var b='style="width:'+h+'px;"';g=g||"&#160;";var c=Sigma.$e("td",{style:{width:a+"px"},innerHTML:'<div class="'+(e?"gt-hd-inner":"gt-inner")+'" '+b+">"+g+"</div>"});return c},freezeHeadCell:function(a,b,c){return this.freezeBodyCell(a,b,c,true)}},Dialog:{create:function(a){var e=a.domId;var c=a.gridId;var b=Sigma.$chk(a.hasCloseButton)?a.hasCloseButton:true;var d=a.title||"Dialog";return['<div class="gt-dialog-head" >','<div class="gt-dialog-head-icon">&#160;</div>','<div id="'+e+'_dialog_title"  class="gt-dialog-head-text" >'+d+"</div>",'<div class="gt-dialog-head-button"  >',b?'<a href="#" onclick="Sigma.$grid(\''+c+"').closeDialog();return false;\">&#160;</a>":"","</div>",'</div><div id="'+e+'_dialog_body" class="gt-dialog-body"></div>'].join("")},filterCondSelect:['<select class="gt-input-select">','<option value="equal">=</option>','<option value="notEqual">!=</option>','<option value="less">&lt;</option>','<option value="great">></option>','<option value="lessEqual">&lt;=</option>','<option value="greatEqual" >>=</option>','<option value="like" >like</option>','<option value="startWith">startWith</option>','<option value="endWith">endWith</option>',"</select>"].join("")}});Sigma.T_G=Sigma.Template.Grid;Sigma.T_C=Sigma.Template.Column;Sigma.T_D=Sigma.Template.Dialog;Sigma.Validator={hasDepend:/^datetime|^date|^time|^gt_minlength|^gt_maxlength|^DT|^D|^T|^MINL|^MAXL/,hasArgument:/^equals|^lessthen|^EQ|^LT/,DATE_FORMAT:"yyyy-MM-dd",TIME_FORMAT:"HH:mm:ss",DATETIME_FORMAT:"yyyy-MM-dd HH:mm:ss",KeyMapping:{R:"required",DT:"datetime",D:"date",T:"time",E:"email",ID:"idcard",N:"number","int":"integer",I:"integer",F:"float",M:"money",RG:"range",EQ:"equals",LT:"lessthen",GT:"greatethen",U:"url",ENC:"enchar",CNC:"cnchar",MINL:"gt_minlength",MAXL:"gt_maxlength"},RegExpLib:{email:/\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/,number:/^\d+$/,integer:/^[1-9]\d*|0$/,"float":/^([1-9]\d*\.\d+|0\.\d+|[1-9]\d*|0)$/,money:/^([1-9]\d*\.\d{1,2}|0\.\d{1,2}|[1-9]\d*|0)$/,telephone:/^[+]{0,1}(\d){1,3}[ ]?([-]?((\d)|[ ]){1,16})+$/,enchar:/^[ \w]*$/,cnchar:/^[\u4E00-\u9FA5\uF900-\uFA2D]*$/,idcard:/^(\d{15}|\d{18}|\d{17}X?)$/i},getValidator:function(a){return Sigma.Validator[a]},getMessage:function(msgKey){var msg=Sigma.Msg.Validator["default"][msgKey];if(!msg){msg=Sigma.Msg.Validator["default"][Sigma.Validator.KeyMapping[msgKey]]}var _format=((Sigma.Validator.KeyMapping[msgKey]||msgKey)+"_FORMAT").toUpperCase();_format=Sigma.Validator[_format];var wordNum=(" "+msg).split(/\{[0-9]/).length-1;for(var i=1;i<=wordNum;i++){var ns=arguments[i];if(i==2){ns=ns||_format}var rex;eval("rex = /{("+(i-1)+"[^#}]*)#?([^}]*)}/;");var ostring=rex.exec(msg);if(ostring&&ostring.length>2){if(!ns){msg=Sigma.U.replaceAll(msg,ostring[0]," "+ostring[2]+" ")}else{msg=Sigma.U.replaceAll(msg,ostring[0]," "+ns+" ")}}}return msg},required:function(a){if(a===null||a===undefined){return false}if(typeof(a)!="string"&&a.length){if(a.length<1){return false}for(var b=0;b<a.length;b++){var c=Sigma.Validator.required(a[b]);if(c){return true}}return false}return Sigma.U.trim(a+"").length>0},telephone:function(a){if(!Sigma.Validator.RegExpLib.telephone.exec(a)){return false}return true},email:function(a){return a&&Sigma.Validator.RegExpLib.email.test(a)},enchar:function(a){return a&&Sigma.Validator.RegExpLib.enchar.test(a)},cnchar:function(a){return a&&Sigma.Validator.RegExpLib.cnchar.test(a)},number:function(a){return !isNaN(a/1)},integer:function(a){return(String(a).indexOf(".")<0)&&!isNaN(a/1)&&Sigma.Validator.RegExpLib.integer.test(Math.abs(a))},"float":function(a){return !isNaN(a/1)&&Sigma.Validator.RegExpLib["float"].test(Math.abs(a))},money:function(a){return !isNaN(a/1)&&Sigma.Validator.RegExpLib.money.test(a)},idcard:function(b){if(!b||b.length<15||!Sigma.Validator.RegExpLib.idcard.test(b)){return false}var a;if(b.length==18){a=b.substr(6,8)}else{a="19"+b.substr(6,6)}return Sigma.Validator.date(a,"YYYYMMDD")},date:function(c,j){c=[].concat(c);if(!j||j.length<1){j=Sigma.Validator.DATE_FORMAT}j=j.toUpperCase();var b=j.replace(/([$^.*+?=!:|\/\\\(\)\[\]\{\}])/g,"\\$1");b=b.replace("YYYY","([0-9]{4})");b=b.replace("YY","([0-9]{2})");b=b.replace("MM","(0[1-9]|10|11|12)");b=b.replace("M","([1-9]|10|11|12)");b=b.replace("DD","(0[1-9]|[12][0-9]|30|31)");b=b.replace("D","([1-9]|[12][0-9]|30|31)");b="^"+b+"$";var n=new RegExp(b);var h=0,f=1,d=1;var g=j.match(/(YYYY|YY|MM|M|DD|D)/g);for(var m=0;m<c.length;m++){if(!n.test(c[m])){return false}var l=n.exec(c[m]);for(var e=0;e<g.length;e++){switch(g[e]){case"YY":case"yy":var k=Number(l[e+1]);h=1900+(k<=30?k+100:k);break;case"YYYY":case"yyyy":h=Number(l[e+1]);break;case"M":case"MM":f=Number(l[e+1]);break;case"D":case"d":case"DD":case"dd":d=Number(l[e+1]);break}}var a=(h%4===0&&(h%100!==0||h%400===0));if(d>30&&(f==2||f==4||f==6||f==9||f==11)){return false}if(f==2&&(d==30||d==29&&!a)){return false}}return true},time:function(d,e){d=[].concat(d);if(!e||e.length<1){e=Sigma.Validator.TIME_FORMAT}var a=e.replace(/([.$?*!=:|{}\(\)\[\]\\\/^])/g,"\\$1");a=a.replace("HH","([01][0-9]|2[0-3])");a=a.replace("H","([0-9]|1[0-9]|2[0-3])");a=a.replace("mm","([0-5][0-9])");a=a.replace("m","([1-5][0-9]|[0-9])");a=a.replace("ss","([0-5][0-9])");a=a.replace("s","([1-5][0-9]|[0-9])");a="^"+a+"$";var c=new RegExp(a);for(var b=0;b<d.length;b++){if(!c.test(d[b])){return false}}return true},datetime:function(f,g){f=[].concat(f);var d=/^\S+ \S+$/;if(!g||g.length<1){g=Sigma.Validator.DATETIME_FORMAT}else{if(!d.test(g)){return false}}for(var e=0;e<f.length;e++){if(!d.test(f[e])){return false}var b=f[e].split(" ");var c=g.split(" ");var a=Sigma.Validator.date(b[0],c[0])&&Sigma.Validator.time(b[1],c[1]);if(!a){return false}}return true},range:function(c,b,a){if(!Sigma.$chk(b)){return c<=a}else{if(!Sigma.$chk(a)){return c>=b}}return c>=b&&c<=a},equals:function(c,a){a=[].concat(a);for(var b=0;b<a.length;b++){if(c==a){return true}}return false},lessthen:function(c,a){a=[].concat(a);for(var b=0;b<a.length;b++){if(c<=a){return true}}return false},greatethen:function(c,a){a=[].concat(a);for(var b=0;b<a.length;b++){if(c>=a){return true}}return false},gt_minlength:function(b,a){return Sigma.$chk(b)&&(b+"").length>=a},gt_maxlength:function(b,a){return Sigma.$chk(b)&&(b+"").length<=a}};(function(){for(var a in Sigma.Validator.KeyMapping){Sigma.Validator[a]=Sigma.Validator[Sigma.Validator.KeyMapping[a]]}})();if(!window.Sigma){window.Sigma={}}SIGMA_GRID_VER="Sigma-Grid 2.4";Sigma.WidgetCache={};Sigma.GridCache={};Sigma.GridNum=0;Sigma.activeGrid=null;Sigma.$widget=function(a){return Sigma.$type(a,"string")?Sigma.WidgetCache[a]:a};Sigma.$grid=function(a){a=a||Sigma.Const.Grid.DEFAULT_ECG_ID;return Sigma.$type(a,"string")?Sigma.GridCache[a]:a};Sigma.destroyGrids=function(){Sigma.eachGrid(function(a){try{a.destroy()}catch(b){}})};Sigma.destroyWidgets=function(){for(var a in Sigma.WidgetCache){var b=Sigma.WidgetCache[a];if(b&&b.destroy){try{b.destroy()}catch(c){}}}};Sigma.eachGrid=function(c){for(var b in Sigma.GridCache){var a=Sigma.GridCache[b];c(a)}};Sigma.GridDefault={id:Sigma.Const.Grid.DEFAULT_ECG_ID,defaultColumnWidth:70,domList:["gridWaiting","separateLine","gridMask","gridGhost","gridFormTextarea","gridFormFileName","gridFormExportType","gridForm","gridIFrame","activeDialog","gridDialog","gridDialogTitle","gridDialogBody","gridFilterRSCache","titleBar","toolTipDiv","freezeHeadTable","freezeHeadDiv","freezeBodyDiv","freezeView","resizeButton","pageSizeSelect","pageStateBar","toolBar","toolBarBox","columnMoveS","headerGhost","headFirstRow","bodyFirstRow","headTable","headDiv","bodyDiv","gridDiv","viewport","container"],defaultConst:["action","recordType","exportType","exportFileName","exception","parameters","queryParameters","data","pageInfo","filterInfo","sortInfo","columnInfo","fieldsName","insertedRecords","updatedRecords","updatedFields","deletedRecords","success","succeedData","failedData","remotePaging","remoteSort","remoteFilter","remoteGroup"],language:"default",skin:"default",dataPageInfo:null,dataException:null,formid:null,isNative:false,loadURL:null,saveURL:null,exportURL:null,exportType:null,exportFileName:null,sortInfo:null,editable:true,resizable:false,allowCustomSkin:false,allowFreeze:false,allowHide:false,allowGroup:false,allowResizeColumn:true,simpleScrollbar:true,scrollbarClass:null,monitorResize:false,readOnly:false,stripeRows:true,lightOverRow:true,evenRowCss:"gt-row-even",clickStartEdit:true,remotePaging:true,remoteSort:false,remoteFilter:false,remoteGroup:false,autoLoad:true,submitColumnInfo:true,autoUpdateSortState:true,autoUpdateEditState:true,autoUpdateGroupState:true,autoUpdateFreezeState:true,autoSelectFirstRow:true,autoEditNext:false,submitUpdatedFields:false,autoSaveOnNav:false,reloadAfterSave:true,recountAfterSave:true,recount:false,showGridMenu:false,showEditTool:true,showAddTool:true,showDelTool:true,showSaveTool:true,showReloadTool:true,showPrintTool:true,showFilterTool:true,showChartTool:true,showPageState:true,showIndexColumn:false,renderHiddenColumn:true,transparentMask:false,justShowFiltered:true,toolbarPosition:"bottom",toolbarContent:"nav | goto | pagesize | reload | add del save | print | filter chart | state",width:"100%",height:"100%",minWidth:50,minHeight:50,dataRoot:"data",custom2Cookie:true,multiSort:false,multiGroup:false,multiSelect:true,selectRowByCheck:false,html2pdf:true,SigmaGridPath:"../../gt-grid",properties:function(){return{skinList:[{text:this.getMsg("STYLE_NAME_DEFAULT"),value:"default"},{text:this.getMsg("STYLE_NAME_PINK"),value:"pink"},{text:this.getMsg("STYLE_NAME_VISTA"),value:"vista"},{text:this.getMsg("STYLE_NAME_MAC"),value:"mac"}],encoding:null,mimeType:null,jsonParamName:null,title:null,lastAction:null,ajax:null,autoExpandColumn:null,autoColumnWidth:false,cellWidthPadding:Sigma.isBoxModel?0:4,cellHeightPadding:Sigma.isBoxModel?0:2,cellWidthFix:Sigma.isBoxModel?0:0,innerWidthFix:Sigma.isBoxModel?0:(Sigma.isIE8?-1:-4),freezeFixH:Sigma.isBoxModel?0:0,freezeFixW:Sigma.isIE?-1:-2,toolbarHeight:24,toolBarTopHeight:0,tableMarginLeft:0,freezeColumns:0,separateLineMinX:0,defaultRecord:null,isWaiting:false,isColumnResizing:false,requesting:false,hasGridDivTemp:false,resizeColumnId:-1,moveColumnDelay:800,mouseDown:false,footDiv:null,footTable:null,footFirstRow:null,freezeBodyTable:null,titleBar:null,nearPageBar:null,lastOverHdCell:null,toolTipDiv:null,gridTable:null,overRow:null,overRowF:null,activeCell:null,activeColumn:null,activeRow:null,activeRecord:null,activeEditor:null,activeDialog:null,scrollLeft:0,scrollTop:0,complatedTimes:0,onComplete:Sigma.$empty,onResize:Sigma.$empty,beforeRowSelect:Sigma.$empty,afterRowSelect:Sigma.$empty,onHeadClick:Sigma.$empty,onCellClick:Sigma.$empty,onCellDblClick:Sigma.$empty,onRowClick:Sigma.$empty,onRowDblClick:Sigma.$empty,beforeEdit:Sigma.$empty,afterEdit:Sigma.$empty,beforeRefresh:Sigma.$empty,beforeExport:Sigma.$empty,beforeSave:Sigma.$empty,beforeLoad:Sigma.$empty,loadResponseHandler:Sigma.$empty,saveResponseHandler:Sigma.$empty,beforeDestroy:Sigma.$empty,beforeDatasetUpdate:Sigma.$empty,onRecordUpdate:Sigma.$empty,beforeInsert:Sigma.$empty,afterInsert:Sigma.$empty,beforeUpdate:Sigma.$empty,afterUpdate:Sigma.$empty,beforeDelete:Sigma.$empty,afterDelete:Sigma.$empty,customRowAttribute:Sigma.$empty,onContextMenu:Sigma.$empty,afterColumnResize:Sigma.$empty,beforeColumnMove:Sigma.$empty,onKeyDown:Sigma.$empty,onMouseMove:Sigma.$empty,onMouseOut:Sigma.$empty,onMouseOver:Sigma.$empty,onRowCheck:Sigma.$empty,editing:false,rendered:false,isFirstLoad:true,customPrintCss:null,gridTbodyList:[],gridRowList:[],gridFreezeRowList:[],checkedRows:{},rowBegin:0,rowNum:0,rowEnd:0,currentRowNum:0,filterDataProxy:null,dataProxyBak:null,cacheData:[],dataset:null,selectedRows:[],cacheBodyList:[],frozenColumnList:[],sortedColumnList:[],countTotal:true,pageSizeList:[],tools:{},toolCreator:{},columns:[],columnList:[],columnMap:{},CONST:null,queryParameters:{},parameters:{}}},activeMe:function(){Sigma.activeGrid=this},clearCheckedRows:function(a){this.checkedRows={};if(a){this.refresh()}},initialize:function(b,j){Sigma.GridNum++;var e={};var a=this;Sigma.$each(this.domList,function(l,m){a[l]=null});Sigma.$each(this.defaultConst,function(l,m){e[l]=l});this.id=""+b;j=j||{};if(Sigma.$type(b,"object")){j=b;this.id="gtgrid_"+Sigma.GridNum}Sigma.$extend(e,j.CONST);this.CONST=e;Sigma.$extend(this,j);this.gridId=this.id;this.rowKey="__gt_"+this.id+"_r_";Sigma.GridCache[this.id]=this;this.legacy();if(!this.dataset&&this.columns){var d={fields:[]};for(var i=0;i<this.columns.length;i++){var c=this.columns[i];var f={name:c.name||c.fieldName||c.id,type:c.type,index:(c.fieldIndex||c.fieldIndex===0)?c.fieldIndex:null};d.fields.push(f)}this.dataset=d}if(this.dataset&&!(this.dataset instanceof Sigma.DataSet)){this.dataset.recordType=this.dataset.recordType||this.recordType;this.dataset=new Sigma.DataSet(this.dataset)}this.loadURL=this.loadURL||this.dataset.loadURL;this.saveURL=this.saveURL||this.dataset.saveURL;this.evenRowCss=" "+this.evenRowCss;this.toolbarContent=this.toolbarContent===false?false:this.toolbarContent;if(this.toolCreator){for(var g in this.toolCreator){Sigma.ToolFactroy.register(g,this.toolCreator[g])}}var h=j.pageInfo||(this.dataset?this.dataset.pageInfo:null)||{};h.pageSize=h.pageSize||j.pageSize||0;if(h.pageSize===0){delete h.pageSize}delete j.pageInfo;delete j.pageSize;delete this.pageInfo;delete this.pageSize;this.navigator=new Sigma.Navigator({gridId:this.id,pageInfo:h})},legacy:function(){var a=this;a.beforeRowSelect=a.beforeRowSelect||a.beforeSelectRow;a.afterRowSelect=a.afterRowSelect||a.afterSelectRow;a.onCellClick=a.onCellClick||a.onClickCell;a.onRowClick=a.onRowClick||a.onClickRow;a.onCellDblClick=a.onCellDblClick||a.onDblClickCell;a.onRowDblClick=a.onRowDblClick||a.onDblClickRow},initColumns:function(e){this.columns=e||this.columns;if(!this.columns){return}this.gridEditorCache=this.gridEditorCache||Sigma.$e("div",{className:"gt-editor-cache"});var b=this.columns.length;var g=0;var k=true;var d={};function h(p,i,l,m,n,o){return this.editor.getDisplayValue(p)}for(var f=0;f<b;f++){var c=this.columns[f];c.grid=this;c.gridId=this.id;if(c.isCheckColumn){c=Sigma.Grid.createCheckColumn(this,c)}var a=new Sigma.Column(c);this.columnMap[a.id]=a;this.columnList.push(a);a.colIndex=f;this.checkColumn=a.isCheckColumn?a:this.checkColumn;if(a.frozen){this.frozenColumnList.push(a.id)}var j=this.dataset.fieldsMap[a.fieldName];if(j){a.fieldIndex=j.index}if(a.editable!==true&&a.editable!==false){a.editable=this.editable}a.editor=Sigma.Editor?Sigma.Editor.factroy(a.editor,this):null;if(a.editor&&a.editor.getDom()){this.gridEditorCache.appendChild(a.editor.getDom())}if(a.renderer=="by editor"&&a.editor){a.renderer=h}else{if(Sigma.$type(a.renderer,"string")){a.renderer=Sigma.U.parseExpression(a.renderer,"record","value,record,col,grid,colNo,rowNo")}}d[a.fieldIndex]=a.newValue||"";a.styleClass=Sigma.T_G.getColStyleClass(this,a.id);a.innerStyleClass=a.styleClass+" .gt-inner";a.minWidth=a.minWidth+this.cellWidthFix;a.innerStartHTML=Sigma.T_G.innerStart(a);if(a.sortOrder){this.addSortInfo(this.createSortInfo(a))}if(a.separator){a.separator.gridId=a.gridId}if(a.hidden){}}this.defaultRecord=this.defaultRecord||d;return this},getMsg:function(a){var b=Sigma.Msg.Grid[this.language][a];return b},_onComplete:function(){if(this.autoSelectFirstRow&&!this.selectRowByCheck){this.selectFirstRow()}this.toggleEmptyRow();Sigma.$invoke(this,"onComplete",[this]);this.hideWaiting();this.complatedTimes++},getEl:function(){return this.gridDiv},initHead:function(){var a=this;this.headDivHeight=this.headDiv.clientHeight;if(this.customHead){this.headDiv.style.height=this.headDivHeight-2+"px";Sigma.$thread(function(){a.headDiv.scrollTop=2});this.headDivHeight-=2}this.freezeHeadDiv.style.height=this.headDivHeight+"px";this.freezeHeadDiv.style.top=0+this.freezeFixH+"px";this.freezeBodyDiv.style.top=this.headDivHeight+this.freezeFixH+0+"px"},initCSS:function(){var a="display:none;";Sigma.Const.Grid.SCROLLBAR_WIDTH=20;var b=this;b.evenRowCss=b.stripeRows?b.evenRowCss:"";var c=[];Sigma.$each(this.columnList,function(e,f){e.width=e.width||b.defaultColumnWidth;var d=""+e.width;if(d.indexOf("px")<1&&d.indexOf("%")<1){d=parseInt(d)}else{if(d.indexOf("%")>0){}else{}}c[f]=[e.CLASS_PREFIX+e.styleClass+" { width:"+(d+b.cellWidthFix)+"px;"+(e.hidden?a:"")+" } ",e.CLASS_PREFIX+e.innerStyleClass+" { width:"+(d+b.innerWidthFix)+"px; } "].join("\n")});Sigma.U.CSS.createStyleSheet(c.join("\n"))},createMain:function(){var b=this;this.pageStateBar=Sigma.$(this.pageStateBar);if(this.isNative){this.gridDiv=Sigma.$(this.id+"_div")}else{var d=[(Sigma.isBoxModel?"gt-b-ie ":(Sigma.isSafari?"gt-b-safari ":(Sigma.isOpera?"gt-b-opera ":(Sigma.isStrict?"gt-b-strict":"")))),"gt-grid","gt-skin-"+this.skin];this.gridDiv=Sigma.$e("div",{id:this.id+"_div",className:d.join(" ")});this.container=Sigma.$(this.container);if(!this.container||!this.container.appendChild||!this.container.tagName||Sigma.U.getTagName(this.container)=="BODY"){Sigma.doc.body.appendChild(this.gridDiv)}else{if(this.replaceContainer===true){this.container.parentNode.insertBefore(this.gridDiv,this.container);Sigma.U.removeNode(this.container);this.container=null}else{this.container.appendChild(this.gridDiv)}}this.gridDiv.innerHTML=Sigma.T_G.main(this)}this.gridDiv.hideFocus=true;this.gridMask=Sigma.$byId(this.id+"_mask");this.gridWaiting=Sigma.$(this.id+"_waiting");this.gridDialog=Sigma.$(this.id+"_dialog");this.gridDialogTitle=Sigma.$(this.id+"_dialog_title");this.gridDialogBody=Sigma.$(this.id+"_dialog_body");this.gridDiv.appendChild(this.gridEditorCache);this.gridFilterRSCache=this.gridFilterRSCache||Sigma.$e("table",{className:"gt-filter-rs-cache"});this.gridDiv.appendChild(this.gridFilterRSCache);this.showMask();this.viewport=Sigma.$(this.id+"_viewport");this.toolBarBox=Sigma.$(this.id+"_toolBarBox");this.headDiv=Sigma.$(this.id+"_headDiv");this.bodyDiv=Sigma.$(this.id+"_bodyDiv");this.freezeView=Sigma.$(this.id+"_freezeView");this.freezeHeadDiv=Sigma.$(this.id+"_freeze_headDiv");this.freezeBodyDiv=Sigma.$(this.id+"_freeze_bodyDiv");this.createHeader();this.separateLine=Sigma.$(this.id+"_separateLine");this.toolBarTopHeight=this.toolbarPosition=="top"||this.toolbarPosition=="t"?this.toolbarHeight+(Sigma.isBoxModel?0:1):0;if(this.separateLine){this.separateLine.style.top=this.toolBarTopHeight+"px"}this.columnMoveS=Sigma.$(this.id+"_columnMoveS");this.headerGhost=Sigma.$(this.id+"_headerGhost");if(this.toolBarBox){this.toolBar=Sigma.$e("div",{id:this.id+"_toolBar",className:"gt-toolbar"});this.toolBarBox.appendChild(this.toolBar)}var c=""+this.width;var a=""+this.height;this.setDimension(c,a,true);this.showWaiting();this.syncLeftTop()},syncLeftTop:function(){this.left=Sigma.U.getPosLeftTop(this.gridDiv);this.top=this.left[1];this.left=this.left[0];this.viewportXY=Sigma.U.getXY(this.viewport)},_onResize:function(e){this.gridMask.style.width=this.width;this.gridMask.style.height=this.height;this.gridDiv.style.width=this.width;this.gridDiv.style.height=this.height;var c=(""+this.height).indexOf("%")>0?this.gridDiv.clientHeight:parseInt(this.height);var b=0-(Sigma.isBoxModel?2:3);var a=c-(this.headDivHeight+this.toolbarHeight)+b;if(a<0){this.bodyDiv.style.height=""}else{this.bodyDiv.style.height=a+"px"}if(Sigma.isOpera){var d=this.gridDiv.clientWidth+b+"px";this.viewport.style.width=d;if(this.toolBarBox){this.toolBarBox.style.width=d}}if(this.freezeBodyDiv){this.freezeBodyDiv.style.height=this.bodyDiv.clientHeight+"px"}if(e!==true){this.onResize()}},createFormIFrame:function(){Sigma.U.createElementFromHTML(Sigma.T_G.formIFrame(this),Sigma.doc.body);this.gridForm=Sigma.$(this.id+"_export_form");this.gridFormTextarea=Sigma.$(this.id+"_export_form_textarea");this.gridFormFileName=Sigma.$(this.id+"_export_filename");this.gridFormExportType=Sigma.$(this.id+"_export_exporttype");this.gridIFrame=Sigma.$(this.id+"_export_iframe")},createGridGhost:function(){this.gridGhost=Sigma.$e("div",{id:this.id+"_gridGhost",className:"gt-grid-ghost-rect"});this.gridGhost.style.top=this.top+"px";this.gridGhost.style.left=this.left+"px";this.gridGhost.style.width=this.gridMask.style.width;this.gridGhost.style.height=this.gridMask.style.height;Sigma.doc.body.appendChild(this.gridGhost)},orphanTr:function(){if(!this.renderHiddenColumn){var a=Sigma.doc.createElement("tr");a.className="gt-orphan-tr";return a}}(),kickHeader:function(){var a=this;var b=a.headTbody.rows[0];if(!this.renderHiddenColumn&&b){Sigma.$each(this.columnList,function(f,d){var e=f.headCell&&f.headCell.parentNode==a.orphanTr;if(f.hidden&&e){a.orphanTr.appendChild(f.headCell)}else{if(e){var c=b.cell[d];if(c){b.insertBefore(f.headCell,c)}}}},this)}},createHeader:function(){var b=this,c;if(this.customHead){this.renderHiddenColumn=true;Sigma.U.removeNode(this.orphanTr);this.orphanTr=null;this.createCustomHeader()}else{this.headTable=Sigma.$e("table",{id:this.id+"_headTable",className:"gt-head-table",cellSpacing:"0",cellPadding:"0",border:"0"});this.headTbody=Sigma.$e("tbody");this.headTable.appendChild(this.headTbody);c=Sigma.$e("tr",{className:"gt-hd-row"});this.headTbody.appendChild(c);Sigma.$each(this.columnList,function(f,e){var d=Sigma.T_G.createHeaderCell(b,f);c.appendChild(d);f.headCell=d;Sigma.Grid.initColumnEvent(b,f)},this);this.kickHeader()}this.headTable.style.marginRight=100+"px";var a=this.headDiv.firstChild?String(Sigma.U.getTagName(this.headDiv.firstChild)):null;if(a=="DIV"||a=="SPAN"){this.headDiv.firstChild.appendChild(this.headTable)}else{this.headDiv.appendChild(this.headTable)}this.headFirstRow=this.headTbody.rows[0];this.freezeHeadTable=Sigma.$e("table",{id:this.headTable.id+"_freeze",className:"gt-head-table",cellSpacing:"0",cellPadding:"0",border:"0"});this.freezeHeadTable.appendChild(Sigma.$e("tbody"));this.freezeHeadTable.style.height="100%";this.freezeHeadDiv.appendChild(this.freezeHeadTable);this.initHead()},createBody:function(){var a=Sigma.$(this.id+"_bodyTable");if(a){this.gridTable=a;this.gridTbodyList.push(a.tBodies[0]);this.bodyFirstRow=this.getFirstRow()}else{this.gotoPage()}},createCustomHeader:function(){var a=this,h;if(Sigma.$type(this.customHead,"string")){if(this.customHead.indexOf("<table")===0){Sigma.U.orphanDiv.innerHTML=this.customHead;this.customHead=Sigma.U.orphanDiv.firstChild}else{this.customHead=Sigma.$(this.customHead)}}this.customHead.style.display="";this.headTable=Sigma.$e(this.customHead,{id:this.id+"_headTable",className:"gt-head-table",cellSpacing:"0",cellPadding:"0",border:"0"});this.headTbody=this.headTable.tBodies[0];for(var e=0;e<this.headTbody.rows.length;e++){var k=this.headTbody.rows[e];k.className="gt-hd-row";for(var d=0;d<k.cells.length;d++){var g=k.cells[d];var f=g.innerHTML;var b=g.getAttribute("columnId");if(b){g.columnId=b;var c=this.columnMap[b];if(String(g.getAttribute("resizable")).toLowerCase()=="false"){c.resizable=false}if(String(g.getAttribute("sortable")).toLowerCase()=="false"){c.sortable=false}if(g.colSpan<2){g.className=c.styleClass}c.headCell=g}g.innerHTML=['<div class="gt-inner',g.rowSpan<2?"":" gt-inner-tall2",'" unselectable="on" >',"<span>",f,"</span>",b?Sigma.T_G.hdToolHTML:"","</div>"].join("")}}h=Sigma.$e("tr",{className:"gt-hd-row"+(this.customHead?" gt-hd-hidden":"")});Sigma.$each(this.columnList,function(l,j){var i=Sigma.T_G.createHeaderCell(a,l,true);h.appendChild(i);Sigma.Grid.initColumnEvent(a,l)});this.headTbody.insertBefore(h,this.headTbody.rows[0])},scrollGrid:function(k,g){var i=this.tableMarginLeft;var h=this.freezeBodyDiv.clientWidth;var j=this.activeCell.offsetLeft+((Sigma.isFF2||Sigma.isFF1)?0:i);var e=j+this.activeCell.offsetWidth;var d=this.activeCell.offsetTop;var c=d+this.activeCell.offsetHeight;var l=this.bodyDiv.scrollLeft;var a=this.bodyDiv.scrollTop;var b=l+this.bodyDiv.clientWidth+i;var f=a+this.bodyDiv.clientHeight;if(Sigma.$chk(k)){this.bodyDiv.scrollLeft=k}else{if(j<=l+h){this.bodyDiv.scrollLeft=j-h-(h>0?1:0)}else{if(e>=b){this.bodyDiv.scrollLeft=l+e-b+i}}}if(Sigma.$chk(g)){this.bodyDiv.scrollTop=g}else{if(d<=a){this.bodyDiv.scrollTop=d}else{if(c>=f){this.bodyDiv.scrollTop=a+c-f}}}},syncActiveObj:function(a){this.activeCell=a=(a||this.activeCell);this.activeRow=a?a.parentNode:null;this.activeColumn=this.getColumn(a);this.activeEditor=this.activeColumn?this.activeColumn.editor:null;this.activeRecord=this.getRecordByRow(this.activeRow)},_prveEditableCell:function(b){var a=Sigma.U.prevElement(b);while(a&&a.offsetWidth<1){a=Sigma.U.prevElement(a)}if(!a){a=Sigma.U.prevElement(b.parentNode);if(a){a=a.cells[a.cells.length-1]}}while(a&&a.offsetWidth<1){a=Sigma.U.prevElement(a)}return a},_nextEditableCell:function(b){var a=Sigma.U.nextElement(b);while(a&&a.offsetWidth<1){a=Sigma.U.nextElement(a)}if(!a){a=Sigma.U.nextElement(b.parentNode);if(a){a=a.cells[0]}}while(a&&a.offsetWidth<1){a=Sigma.U.nextElement(a)}return a},_onKeydown:function(b){var i=this.activeCell;var d=null;var g=b.keyCode;var a=this;function c(j){if(j){a.endEdit();Sigma.U.stopEvent(b);Sigma.Grid.handleOverRowCore(b,a,j.parentNode);a.initActiveObj_startEdit(b,j)}}if(g==Sigma.Const.Key.ESC){if(this.endEdit()===false){return}else{Sigma.U.stopEvent(b)}}else{if(g==Sigma.Const.Key.ENTER){var h=Sigma.U.getEventTarget(b);if(this.editing&&Sigma.U.getTagName(h)=="TEXTAREA"){return}Sigma.U.stopEvent(b);if(this.editing){if(!this.autoEditNext){this.endEdit();return}d=this._nextEditableCell(i);c(d)}else{this.syncActiveObj(d);this.startEdit()}}else{if(this.editing&&g==Sigma.Const.Key.TAB&&b.shiftKey){d=this._prveEditableCell(i);c(d)}else{if(this.editing&&g==Sigma.Const.Key.TAB){d=this._nextEditableCell(i);c(d)}else{if(i&&!this.editing){switch(g){case Sigma.Const.Key.LEFT:case Sigma.Const.Key.TAB:if(g==Sigma.Const.Key.LEFT||b.shiftKey){d=this._prveEditableCell(i);while(this.isGroupRow(d)){d=this._prveEditableCell(d)}break}case Sigma.Const.Key.RIGHT:d=this._nextEditableCell(i);while(this.isGroupRow(d)){d=this._nextEditableCell(d)}break;case Sigma.Const.Key.DOWN:d=Sigma.U.nextElement(i.parentNode);while(this.isGroupRow(null,d)){d=Sigma.U.nextElement(d)}if(d){d=d.cells[Sigma.U.getCellIndex(i)]}break;case Sigma.Const.Key.UP:d=Sigma.U.prevElement(i.parentNode);while(this.isGroupRow(null,d)){d=Sigma.U.prevElement(d)}if(d){d=d.cells[Sigma.U.getCellIndex(i)]}break}if(d){Sigma.U.stopEvent(b);var e=i.parentNode,f=d.parentNode;this._onRowSelect(f,b);Sigma.Grid.handleOverRowCore(b,this,f);this.initActiveObj(b,d)}}}}}}},startEdit:function(){if(!this.readOnly&&this.activeCell&&this.activeEditor&&(this.activeColumn.editable||this.isInsertRow(this.activeRow))&&Sigma.$invoke(this.activeColumn,"beforeEdit",[this.activeValue,this.activeRecord,this.activeColumn,this])!==false&&Sigma.$invoke(this,"beforeEdit",[this.activeValue,this.activeRecord,this.activeColumn,this])!==false&&!this.isDelRow(this.activeRow)){this.editing=true;this.showEditor(this.activeValue,this.activeRecord)}},showEditor:function(d,b){var a=this.activeCell,e=this.bodyDiv;var c=this.tableMarginLeft;if(this.activeColumn.frozen){a=this.getTwinCells(this.activeCell)[1];e=this.freezeBodyDiv;c=0}if(this.activeEditor&&this.activeEditor instanceof Sigma.Dialog){}else{e.appendChild(this.activeEditor.getDom())}this.activeEditor.show();this.activeEditor.setValue(d,b);if(this.activeEditor!==this.activeDialog){this.activeEditor.setPosition(((Sigma.isFF2||Sigma.isFF1)?0:c)+a.offsetLeft,a.offsetTop);this.activeEditor.setSize(a.offsetWidth,a.offsetHeight)}this.activeEditor.active()},validValue:function(e,d,b,a){if(e.editor){var c=e.editor.doValid(d,b,e,this);if(c!==true){this.showValidResult(d,c,a,e)}return c}return true},hideEditor:function(){if(this.editing){var d=this.activeRow;var b=this.activeValue;var c=this.activeEditor.parseValue(this.activeEditor.getValue());var a=this.validValue(this.activeColumn,c,this.activeRecord,this.activeCell);if(a===true&&String(this.activeValue)!==String(c)){this.updateRecordField(this.activeCell,c);this.refreshRow(d,this.activeRecord);this.dirty(this.activeCell);this.activeValue=c}Sigma.$invoke(this.activeColumn,"afterEdit",[c,b,this.activeRecord,this.activeColumn,this]);Sigma.$invoke(this,"afterEdit",[c,b,this.activeRecord,this.activeColumn,this])}if(this.activeEditor&&this.activeEditor instanceof Sigma.Dialog){}else{this.gridEditorCache.appendChild(this.activeEditor.getDom())}this.activeEditor.hide()},showValidResult:function(e,b,a,d){var c=this.getTwinCells(a);Sigma.U.addClass(c[0],"gt-cell-vaildfailed");Sigma.U.addClass(c[1],"gt-cell-vaildfailed");b=[].concat(b);alert(b.join("\n")+"\n\n"+e);Sigma.$thread(function(){Sigma.U.removeClass(c[0],"gt-cell-vaildfailed");Sigma.U.removeClass(c[1],"gt-cell-vaildfailed")},1500)},getTwinRows:function(e){var d=e,c=e.rowIndex;var a=!d.id?this.gridTbodyList[0]:this.freezeBodyTable.tBodies[0];if(c==-1){c=0}var b=a?a.rows[c]:null;if(!b&&a&&a.parentNode.tFoot){b=a.parentNode.tFoot.rows[c-a.rows.length]}return d.id?[d,b,c]:[b,d,c]},getTwinCells:function(a,f){var c=a,e=Sigma.U.getCellIndex(a),b=null,d=0;var g=a.parentNode;f=f||this.getTwinRows(g);if(f[1]==g){d=e-(this.showIndexColumn?1:1);return[f[0]?f[0].cells[d]:null,a,e]}d=e+(this.showIndexColumn?1:1);return[a,f[1]?f[1].cells[d]:null,e]},syncTwinRowCell:function(f,a){if(!f&&!a){return}f=f||a.parentNode;var d=this.getTwinRows(f);var e=d[1];f=d[0];if(e&&f){e.className=f.className;Sigma.U.removeClass(e,"gt-row-over")}if(a){var b=this.getTwinCells(a,d);var c=b[1];a=b[0];if(c&&a){c.className=a.className;if(c.getElementsByTagName("input")[0]){a.innerHTML=c.innerHTML}else{c.innerHTML=a.innerHTML}}}},initActiveObj:function(b,a){a=a||Sigma.U.getParentByTagName("td",null,b);return this.focusCell(a)},initActiveObj_startEdit:function(c,d,b){if(this.rowNum<1){return}var a=this.activeCell;this.initActiveObj(c,d);if(this.activeEditor&&(this.clickStartEdit||a&&a==this.activeCell)){Sigma.U.stopEvent(c);this.syncActiveObj(d);this.startEdit()}},getLastSelectRow:function(){return this.selectedRows[this.selectedRows.length-1]},_onCellSelect:function(a){Sigma.$invoke(this,"onCellSelect",[this.activeValue,this.activeRecord,a.cell,a.row,a.colNo,a.rowNo,a.column,this])},_onRowSelect:function(e,c){if(!e||Sigma.U.hasClass(e.cells[0],"gt-nodata-cell")){return}if(this.multiSelect&&c.shiftKey){var b=this.getLastSelectRow();if(b&&b.parentNode==e.parentNode){this.unselectAllRow();var a=b.rowIndex>e.rowIndex?"prevElement":"nextElement";while(b&&b!=e){this.selectRow(b,true);b=Sigma.U[a](b)}this.selectRow(e,true);return e}}var d=c.ctrlKey;if(Sigma.Grid.isSelectedRow(e)){if(this.multiSelect&&d!==true&&this.selectedRows.length>1){this.unselectAllRow();this.selectRow(e,true)}else{if(d){this.selectRow(e,false)}}}else{if(!this.multiSelect||d!==true){this.unselectAllRow()}this.selectRow(e,true)}return e},_onCellClick:function(b,a,c){Sigma.$invoke(this,"onCellClick",[c.value,c.record,c.cell,c.row,c.colNo,c.rowNo,c.column,this,b])},_onCellDblClick:function(b,a,c){Sigma.$invoke(this,"onCellDblClick",[c.value,c.record,c.cell,c.row,c.colNo,c.rowNo,c.column,this,b])},_onRowClick:function(a,c,b){Sigma.$invoke(this,"onRowClick",[b.value,b.record,b.cell,b.row,b.colNo,b.rowNo,b.column,this,a])},_onRowDblClick:function(a,c,b){Sigma.$invoke(this,"onRowDblClick",[b.value,b.record,b.cell,b.row,b.colNo,b.rowNo,b.column,this,a])},_onBodyClick:function(d,c,b,h){this.endEdit();this.activeMe();var a=h.cell,g;if(!a||a==b){return}a=this.getTwinCells(a)[0];if(a){g=a.parentNode}else{g=this.getTwinRows(h.row)[0]}var e=h.eventTarget;var f=(Sigma.U.getTagName(e)=="INPUT"&&e.className=="gt-f-check");if(f){Sigma.checkOneBox(e,this)}this._onCellSelect(h);if(!this.selectRowByCheck){this._onRowSelect(g,d)}if(c){this._onCellDblClick(d,a,h);this._onRowDblClick(d,g,h)}else{this._onCellClick(d,a,h);this._onRowClick(d,g,h)}if(!Sigma.U.hasClass(a,"gt-index-col")){this.initActiveObj_startEdit(d,a,c)}else{}this.syncTwinRowCell(null,a)},clickCount:0,clickInterval:500,_eventHandler:function(d,a,c){var b=this;if(c==b.bodyDiv){if(a=="scroll"){b.activeMe();b.closeGridMenu();b.syncScroll();return}}else{if(c==b.freezeBodyDiv){}}var e=this.getEventTargets(d);if(b.lightOverRow&&a=="mousemove"){Sigma.Grid.handleOverRow(d,b,c)}switch(a){case"contextmenu":Sigma.$invoke(b,"onContextMenu",[e.value,e.record,e.cell,e.row,e.colNo,e.rowNo,e.column,b]);break;case"dblclick":this.clickCount=0;return b._onBodyClick(d,true,c,e);case"click":Sigma.$thread(function(){b.clickCount=0},b.clickInterval);this.clickCount++;return b._onBodyClick(d,false,c,e);case"mouseover":Sigma.$invoke(b,"onMouseOver",[e.value,e.record,e.cell,e.row,e.colNo,e.rowNo,e.column,b]);break;case"mousemove":Sigma.$invoke(b,"onMouseMove",[e.value,e.record,e.cell,e.row,e.colNo,e.rowNo,e.column,b]);break;case"mouseout":Sigma.$invoke(b,"onMouseOut",[e.value,e.record,e.cell,e.row,e.colNo,e.rowNo,e.column,b]);break;default:a=(a.indexOf("on")!==0?"on"+a:a).toLowerCase();return Sigma.$invoke(b,a,[d,b,e,a,c])}},bindEvent:function(c,a){var b=this;Sigma.U.addEvent(c,a,function(d){b._eventHandler(d,a,c)})},initMainEvent:function(){var a=this;Sigma.initGlobalEvent();if(a.monitorResize){Sigma.U.addEvent(window,"resize",function(c){a._onResize()});a.hasResizeListener=true}Sigma.U.addEvent(a.gridDiv,"mousedown",function(c){a.activeMe()});a.bindEvent(a.bodyDiv,"scroll");a.bindEvent(a.bodyDiv,"click");a.bindEvent(a.bodyDiv,"dblclick");a.bindEvent(a.bodyDiv,"contextmenu");a.bindEvent(a.freezeBodyDiv,"click");a.bindEvent(a.freezeBodyDiv,"dblclick");Sigma.U.addEvent(a.headDiv,"selectstart",function(c){Sigma.U.stopEvent(c);return false});a.bindEvent(a.bodyDiv,"mouseover");a.bindEvent(a.bodyDiv,"mouseout");a.bindEvent(a.bodyDiv,"mousemove");a.bindEvent(a.freezeBodyDiv,"mousemove");function b(d){d=d||window.event;var c=Sigma.U.getParentByTagName("td",null,d);if(c){Sigma.U.addClass(c,"gt-hd-row-over")}if(a.lastOverHdCell!=c){Sigma.U.removeClass(a.lastOverHdCell,"gt-hd-row-over")}a.lastOverHdCell=c}Sigma.U.addEvent(a.headTable,"mousemove",b);Sigma.U.addEvent(a.freezeHeadTable,"mousemove",b)},showCellToolTip:function(a,b){if(!this.toolTipDiv){this.toolTipDiv=Sigma.$e("div",{className:"gt-cell-tooltip gt-breakline"});this.toolTipDiv.style.display="none"}this.toolTipDiv.innerHTML=Sigma.$getText(a);this.gridDiv.appendChild(this.toolTipDiv);this.toolTipDiv.style.left=a.offsetLeft+this.bodyDiv.offsetLeft-this.bodyDiv.scrollLeft+((Sigma.isFF2||Sigma.isFF1)?0:this.tableMarginLeft)+"px";this.toolTipDiv.style.top=a.offsetTop+a.offsetHeight+this.bodyDiv.offsetTop-this.bodyDiv.scrollTop+this.toolBarTopHeight+(Sigma.isFF?1:0)+"px";b&&(this.toolTipDiv.style.width=b+"px");this.toolTipDiv.style.display="block"},setParameters:function(a){this.parameters=a},setQueryParameters:function(a){this.queryParameters=a},cleanQueryParameters:function(){this.queryParameters={}},addQueryParameter:function(a,b){this.queryParameters=Sigma.U.add2Map(a,b,this.queryParameters)},removeQueryParameter:function(b){var a=this.queryParameters[b];this.queryParameters[b]=undefined;delete this.queryParameters[b];return a},exceptionHandler:function(a,b){alert(b+"\n\n"+a)},getUpdatedFields:function(){return Sigma.$array(this.dataset.updatedFields)},getColumnInfo:function(){var b=[];for(var e=0;e<this.columnList.length;e++){var d=this.columnList[e];var a={id:d.id,header:d.header||d.title,fieldName:d.fieldName,fieldIndex:d.fieldIndex,sortOrder:d.sortOrder,hidden:d.hidden,exportable:d.exportable,printable:d.printable};b.push(a)}return b},getSaveParam:function(a){a=a||{};a[this.CONST.fieldsName]=this.dataset.fieldsName;a[this.CONST.recordType]=this.dataset.getRecordType();a[this.CONST.parameters]=this.parameters;this.submitUpdatedFields&&(a[this.CONST.updatedFields]=this.getUpdatedFields());return a},getLoadParam:function(a){a=a||{};a[this.CONST.recordType]=this.dataset.getRecordType();a[this.CONST.pageInfo]=this.getPageInfo(true);this.submitColumnInfo&&(a[this.CONST.columnInfo]=this.getColumnInfo());a[this.CONST.sortInfo]=this.getSortInfo();a[this.CONST.filterInfo]=this.getFilterInfo();a[this.CONST.remotePaging]=this.remotePaging;a[this.CONST.parameters]=this.parameters;if(this.recount){a[this.CONST.pageInfo].totalRowNum=-1}return a},request:function(b,a,d,i,f){var c=this;c.requesting=true;var g=a[c.CONST.action];if(b){try{c.ajax=new Sigma.Ajax(b);c.ajax.encoding=c.encoding||c.ajax.encoding;c.ajax.method=c.ajaxMethod||c.ajax.method;c.ajax.mimeType=c.mimeType||c.ajax.mimeType;c.ajax.jsonParamName=c.jsonParamName||c.ajax.jsonParamName;c.ajax.onSuccess=i||Sigma.$empty;c.ajax.onFailure=f||Sigma.$empty;c.ajax.setQueryParameters(c.queryParameters);c.ajax.send({data:a})}catch(h){f({status:"Exception "+h.message},h)}}else{f({status:"url is null"})}},load:function(g,e){var c=this;var b=this.loadURL;var f=(!this.autoLoad&&!this.rendered);if(f){c.hideWaiting();c.hideFreezeZone();return}this.remotePaging=this.remotePaging===false?false:!!b;var a=this.getLoadParam();if(g===true){a[this.CONST.pageInfo].totalRowNum=-1}a[this.CONST.action]="load";if(Sigma.$invoke(this,"beforeLoad",[a,this])!==false){if(!b||(e!==true&&this.remotePaging===false&&!this.isFirstLoad)){c.requesting=true;c.loadCallBack(function(){var i={};i[c.dataRoot]=c.dataset.data||[];var j=c.getPageInfo();var h=c.dataset.getSize();j.totalRowNum=h>0?h:0;i[c.CONST.pageInfo]=j;return i}(c),a);return}this.showWaiting();var d=this.request(b,a,"json",function(h){c.loadCallBack(h,a)},function(i,h){var j={};j[c.CONST.exception]=" XMLHttpRequest Status : "+i.status;c.loadFailure(j,h);c.hideWaiting()});this.isFirstLoad=false;return d}else{c.hideWaiting()}return false},query:function(a){this.setQueryParameters(a);this.lastAction="query";this.reload(true,true)},saveCallBack:function(b,c,a){var d=this.responseCallBack(b,c);if(this.requesting){var f=Sigma.$extend({},d);this.requesting=false;var e=!(f[this.CONST.success]===false||f[this.CONST.success]==="false");if(e){this.saveSuccess(f,a)}else{this.saveFailure(f)}this.hideWaiting();Sigma.$invoke(this,"afterSave",[f,e,this])}},saveSuccess:function(b,a){this.dataset.cleanModifiedData(true);if(this.reloadAfterSave||this.autoSaveOnNav&&a){if(this.recountAfterSave){this.getPageInfo().totalRowNum=-1}else{if(b[this.CONST.pageInfo]){this.getPageInfo().totalRowNum=b[b.CONST.pageInfo].totalRowNum||this.getPageInfo().totalRowNum}}this.reload()}},loadSuccess:function(a){this.setContent(a)},loadCallBack:function(a,b){var c=this.responseCallBack(a,b);if(this.requesting){var d=Sigma.$extend({},c);if(d[this.CONST.success]===false||d[this.CONST.success]==="false"){this.loadFailure(d);this.hideWaiting()}else{this.loadSuccess(d)}this.requesting=false}},responseCallBack:function(response,reqParam,action){action=action||reqParam[this.CONST.action];response=Sigma.$invoke(this,action+"ResponseHandler",[response,reqParam])||response;if(!response||Sigma.$type(response,"string","number")){response={text:response}}var respT=null;try{respT=response.text?eval("("+response.text+")"):response}catch(e){respT={text:response.text};respT[this.CONST.exception]=respT.text}if(respT[this.CONST.exception]){respT[this.CONST.success]=false}return respT},loadFailure:function(c,a){var b=c[this.CONST.exception]||(a?a.message:undefined);alert(" LOAD Failed! \n Exception : \n"+b)},saveFailure:function(c,a){var b=c[this.CONST.exception]||(a?a.message:undefined);alert(" SAVE Failed! \n Exception : \n"+b)},exportFailure:function(c,a){var b=c[this.CONST.exception]||(a?(a.message||""):"");alert(" Export "+c.type+" ( "+c.fileName+" ) Failed! \n Exception : \n"+b)},updateRecordField:function(d,c){var b=this.getColumn(d);if(b){var a=this.getRecordByRow(d.parentNode);return this.update(a,b.fieldName,c)}return false},update:function(a,c,b){if(Sigma.$invoke(this,"beforeUpdate",[a,c,b])!==false){this.dataset.updateRecord(a,c,b);return true}},cloneDefaultRecord:function(){var a=this.defaultRecord;if(Sigma.$type(a,"function")){a=a(this,this.dataset,this.dataset.getSize())}return Sigma.$clone(a)},renderInsertedRow:function(c){var f,b;var d=this.colNum;var a=Sigma.T_G.rowStart(this,this.rowNum);if(!this.gridTable.tFoot){this.gridTable.appendChild(Sigma.$e("tfoot"))}if(!this.freezeBodyTable.tFoot){this.freezeBodyTable.appendChild(Sigma.$e("tfoot"))}f=Sigma.U.createTrFromHTML(this.buildGridRow(a,c,this.rowNum,d),this.gridTable.tFoot);if(this.showIndexColumn){b=Sigma.U.createTrFromHTML(this.buildGridIndexRow(a,c,this.rowNum,d),this.freezeBodyTable.tFoot)}else{b=Sigma.U.createTrFromHTML(a+"</tr>",this.freezeBodyTable.tFoot);b.appendChild(Sigma.T_G.freezeBodyCell(this,10,null))}Sigma.U.addClass(f,"gt-row-new");Sigma.U.addClass(b,"gt-row-new");var e=c[Sigma.Const.DataSet.ROW_KEY];f.id=e;f.setAttribute(Sigma.Const.DataSet.INDEX,c[Sigma.Const.DataSet.SN_FIELD]);return[f,b]},hasDataRow:function(){var b=this.getRows().length>0;var a=!!(this.gridTable.tFoot&&this.gridTable.tFoot.rows.length>0);return b||a},toggleEmptyRow:function(){if(!this.hasDataRow()){var a=['<tr class="gt-row gt-row-empty" >'];for(var c=0;c<this.colNum;c++){a.push(Sigma.T_G.cell(this.columnList[c],"&#160;"))}a.push(Sigma.T_G.rowEndHTML);Sigma.U.createTrFromHTML(a.join(""),this.gridTbodyList[0])}else{var b=this.getFirstRow();if(this.isEmptyRow(b)){Sigma.U.removeNode(b)}}},refreshGrid:function(c){c=c||this;var b=c.dataset.getSize();var i=c.getPageInfo();if(!c.remotePaging&&!i.pageSize){i.pageSize=b}b=b>i.pageSize?i.pageSize:b;var f=c.dataset.startRecordNo;c.rowNum=b;c.rowBegin=f;c.rowEnd=f+b;c.colNum=c.columnList.length;c.tableMarginLeft=0;var h=[];var d=[];c.buildGridTable(c,h,d);c.bodyDiv.innerHTML=h.join("");c.freezeBodyDiv.innerHTML=d.join("");var e=Sigma.U.firstChildElement(c.bodyDiv);if(e){if(Sigma.U.getTagName(e)!="TABLE"){e=Sigma.U.nextElement(e)}if(Sigma.U.getTagName(e)=="TABLE"){c.gridTable=e;c.gridTbodyList.push(e.tBodies[0])}}e=Sigma.U.firstChildElement(c.freezeBodyDiv);if(e){if(Sigma.U.getTagName(e)!="TABLE"){e=Sigma.U.nextElement(e)}c.freezeBodyTable=e}c.bodyFirstRow=c.getFirstRow();if(c.rowNum<1){for(var g=0;g<c.colNum;g++){var a=c.columnList[g];if(c.bodyFirstRow){a.firstCell=c.bodyFirstRow.cells[g];a.firstCell.style.height="0px";a.firstCell.style.borderBottomWidth="0px"}}}c.hasIndexColumn=c.showIndexColumn;c.isEmptyfreezeZone=true;Sigma.$thread(function(){c.freezeBodyDiv.style.height=c.bodyDiv.clientHeight+"px";c.syncScroll()})},hideFreezeZone:function(){this.freezeHeadDiv&&(this.freezeHeadDiv.style.display="none");this.freezeBodyDiv&&(this.freezeBodyDiv.style.display="none")},cleanFreezeHead:function(){var a=this.freezeHeadTable.tBodies[0];for(var b=a.rows.length-1;b>=0;b--){Sigma.U.removeNodeTree(a.rows[b])}},buildGridTable:function(a,k,b){var c=(""+a.rowEnd).length;c=(c<2?1.5:c)*7+2+1;var e=c+this.cellWidthFix;var i=c+this.innerWidthFix;var h='style="width:'+e+'px;"';var g='style="width:'+i+'px;"';this.indexColumnCell=['<td class="gt-index-col" '+h+' ><div class="gt-inner" '+g+" >","</div></td>"];if(a.showIndexColumn){a.tableMarginLeft=c;a.cleanFreezeHead();var l=Sigma.$e("tr",{className:"gt-hd-row"});var f=Sigma.T_G.freezeHeadCell(a,c,null);l.appendChild(f);a.freezeHeadTable.tBodies[0].appendChild(l);a.freezeHeadDiv.style.left=a.freezeBodyDiv.style.left=this.freezeFixW+"px";a.headTable.style.marginLeft=a.tableMarginLeft+"px";a.freezeHeadDiv.style.display=a.freezeBodyDiv.style.display="block";a.freezeBodyDiv.style.height=parseInt(a.bodyDiv.style.height)+"px"}else{a.freezeHeadDiv.style.display=a.freezeBodyDiv.style.display="none"}b.push(Sigma.T_G.tableStartHTML);k.push(Sigma.U.replaceAll(Sigma.T_G.tableStartHTML,"margin-left:0px","margin-left:"+a.tableMarginLeft+"px"));var j=a.rowBegin;var d=a.rowEnd;a.currentRowNum=j;a.getGridBodyHTML(j,d,-1,k,b);b.push(Sigma.T_G.tableEndHTML)},isNextGroup:function(a,c,b){},isGroupRow:function(a,b){a=a||(b?b.cells[0]:null);return Sigma.U.hasClass(a,"gt-group-row")},isEmptyRow:function(a){return !a||Sigma.U.hasClass(a,"gt-row-empty")},isInsertRow:function(a){return Sigma.U.hasClass(a,"gt-row-new")},isDelRow:function(a){return Sigma.U.hasClass(a,"gt-row-del")},buildGridIndexRow:function(c,b,e,d){var a=[c];a.push(this.indexColumnCell[0]);a.push(e+1+this.indexColumnCell[1]);a.push(Sigma.T_G.rowEndHTML);return a.join("")},buildGridRow:function(i,f,a,c,b){var j=[i];var e=0;for(var h=0;h<c;h++){var d=this.columnList[h];if(d.hidden&&!this.renderHiddenColumn){continue}var g=b&&b[d.id]?b[d.id].attr:null;j.push(Sigma.T_G.cell(d,d.renderer(f[d.fieldIndex],f,d,this,e,a),g));e++}j.push(Sigma.T_G.rowEndHTML);return j.join("")},buildGroupGridRow:function(d,c,f,e){var b=[d];var a='<td colspan="'+e+'" class="gt-group-row" > + '+f+" -------------</td>";b.push(a);b.push(Sigma.T_G.rowEndHTML);return b.join("")},resetFreeze:function(a){},updateFreezeState:function(){if(this.frozenColumnList){var a,b;for(a=0;a<this.frozenColumnList.length;a++){b=this.columnMap[this.frozenColumnList[a]];if(b){this.moveColumn(b.colIndex,a,true)}}for(a=0;a<this.frozenColumnList.length;a++){b=this.columnMap[this.frozenColumnList[a]];if(b){b.freeze(true)}}}},getGroupInfo:function(b,a){return this.getMergeGroupInfo(b,a)},getSeparateGroupInfo:function(h,c){var a=this.colNum;var d=null;for(var j=0;j<a;j++){var b=this.columnList[j];if(b.grouped){d=b;break}}var m={};if(d){var k=c-h;var g=h;for(var e=0;e<k;e++){var f=this.dataset.getRecord(g++);if(!f){continue}var l=this.getUniqueField(f)}}},getMergeGroupInfo:function(j,e){var c=this.colNum;var l=e-j;var q,m,n=1;var b={},d=null;var p=[];for(var k=0;k<c;k++){var a=this.columnList[k];var h=j;for(var f=0;f<l;f++){var g=this.dataset.getRecord(h++);if(!g){continue}q=p[f]=p[f]||{};var o=q.__gt_group_s_;if(a.grouped){m=q[a.id]=q[a.id]||{};if(d==g[a.fieldIndex]&&(!o&&o!==0||o>k)){m.attr=' style="display:none;" ';n++}else{b.attr=' rowspan="'+n+'" style="background-color: #eef6ff;"  ';n=1;b=m;d=g[a.fieldIndex];q.__gt_group_s_=k}}}b.attr=' rowspan="'+n+'" style="background-color: #eef6ff;"  '}return p},createSortInfo:function(a){return{columnId:a.id,fieldName:a.fieldName,sortOrder:a.sortOrder,getSortValue:a.getSortValue,sortFn:a.sortFn}},_doSort:function(){if(!this.sortInfo||this.sortInfo.length<1){return}this.dataset.sort(this.sortInfo)},addSortInfo:function(c,g){g=g||g===false?g:this.multiSort;var d=[],f=false;for(var h=0;h<this.columnList.length;h++){var a=this.columnList[h];if(a.grouped){if(!f&&a.id==c.columnId){a.sortOrder=c.sortOrder;f=true}else{var l=a.sortOrder;l=l=="asc"||l=="desc"?l:"asc";a.sortOrder=l}d.push(this.createSortInfo(a))}}if(!f&&g!==true){this.sortInfo=d.concat(c);return}this.sortInfo=this.sortInfo||[];var b=c.columnId;var k=false,j,e;for(e=0;e<this.sortInfo.length;e++){j=this.sortInfo[e];if(j&&j.columnId===b){j.sortOrder=c.sortOrder;k=true;break}}!k&&(this.sortInfo.push(c));for(e=0;e<this.sortInfo.length;e++){j=this.sortInfo[e];if(!j||(!j.sortOrder||j.sortOrder=="defaultsort")){this.sortInfo.splice(e,1);e--}}},updateSortState:function(){var g,h;for(h=0;h<this.colNum;h++){g=this.columnList[h];g.sortIcon&&(g.sortIcon.className="gt-hd-icon");g.frozenSortIcon&&(g.frozenSortIcon.className="gt-hd-icon");g.sortOrder=null}if(!this.sortInfo||this.sortInfo.length<1){return}for(var e=0;e<this.sortInfo.length;e++){var b=this.sortInfo[e];if(b){g=this.columnMap[b.columnId];var f=b.sortOrder||"defaultsort";g.sortOrder=f;Sigma.U.addClass(g.sortIcon,"gt-hd-"+f);Sigma.U.addClass(g.frozenSortIcon,"gt-hd-"+f)}}var d=this.getFirstRow();if(d&&!this.isEmptyRow(d)){this.bodyFirstRow=d;var c=0;for(h=0;h<this.colNum;h++){var a=this.columnList[h];if(!a.hidden||this.renderHiddenColumn){a.firstCell=this.bodyFirstRow.cells[c];a.firstCell.className=a.styleClass;c++}}}},getRecordByRow:function(c){if(!c){return null}if(this.isInsertRow(c)){var a=c.getAttribute(Sigma.Const.DataSet.INDEX);return this.dataset.insertedRecords[a]}var b=c.getAttribute(Sigma.Const.DataSet.INDEX)/1;return b||b===0?this.dataset.getRecord(b):null},getRowByRecord:function(a){var b=a[Sigma.Const.DataSet.ROW_KEY];return Sigma.doc.getElementById(b)},getUniqueField:function(a){return a[this.dataset.uniqueField]},updateCheckState:function(){var h=this.checkColumn;if(h){var c=h.colIndex;var f=this.getRows();for(var e=0,b=f.length;e<b;e++){var g=f[e];var a=g.cells[c];var d=a?a.getElementsByTagName("input"):null;d=d?d[0]:d;if(d&&d.checked){this.selectRow(g,true)}}}},updateEditState:function(){var b=this.getInsertedRecords(),n,g,e,d,c;for(e=0;e<b.length;e++){this.renderInsertedRow(b[e])}for(c in this.dataset.updatedRecords){g=this.dataset.updatedRecords[c];var h=this.dataset.updatedRecordsBak[c];n=this.getRowByRecord(g);if(n){var m=this.getRecordByRow(n);if(m){for(var l in h){m[l]=g[l];for(e=0,d=this.columnList.length;e<d;e++){var a=this.columnList[e];if(l==a.fieldIndex&&n.cells){this.dirty(n.cells[e]);n.cells[e].firstChild.innerHTML=a.renderer(m[a.fieldIndex],m,a,this,e,n.rowIndex)}}}}this.dataset.updatedRecords[c]=m}}for(c in this.dataset.deletedRecords){g=this.dataset.deletedRecords[c];n=this.getRowByRecord(g);this.deleteRow(n)}},syncScroll:function(b,a){if(Sigma.$chk(b)){this.bodyDiv.scrollLeft=b}if(Sigma.$chk(a)){this.bodyDiv.scrollTop=a}this.headDiv.scrollLeft=this.bodyDiv.scrollLeft;this.freezeBodyDiv.scrollTop=this.bodyDiv.scrollTop;this.scrollLeft=this.bodyDiv.scrollLeft;this.scrollTop=this.bodyDiv.scrollTop},initToolbar:function(){if(this.resizable&&(this.toolbarPosition=="bottom"||this.toolbarPosition=="b")&&this.toolBarBox){this.resizeButton=Sigma.$e("div",{id:this.id+"_resizeButton",className:"gt-tool-resize",innerHTML:"&#160;"});this.resizeButton.setAttribute("unselectable","on");this.toolBarBox.appendChild(this.resizeButton);var g=this;Sigma.U.addEvent(this.resizeButton,"mousedown",function(b){Sigma.Grid.startGridResize(b,g)})}this.createGridMenu();if(this.toolbarContent&&this.toolbarPosition&&this.toolbarPosition!="none"){this.toolbarContent=this.toolbarContent.toLowerCase();var d=this.toolbarContent.split(" ");var c=null;for(var f=0;f<d.length;f++){var a=d[f];if(a=="|"){var h=Sigma.ToolFactroy.create(this,"separator",true);if(c){c.separator=h}}else{if(a=="state"||a=="info"||a=="pagestate"){if(!this.pageStateBar){this.pageStateBar=Sigma.ToolFactroy.create(this,"pagestate",this.showPageState)}if(f!=d.length-1){this.pageStateBar.className+=" gt-page-state-left"}c=this.pageStateBar}else{if(a=="nav"){this.navigator.buildNavTools(this);c=this.navigator}else{var e=a.charAt(0).toUpperCase()+a.substring(1);c=this.tools[a+"Tool"]=Sigma.ToolFactroy.create(this,a,this["show"+e+"Tool"])}}}}}this.expendMenu={};this.over_initToolbar=true},refreshToolBar:function(a,b){a&&(this.setPageInfo(a));if(this.over_initToolbar){this.navigator.refreshState(a,b);this.navigator.refreshNavBar();var c=this.navigator.pageInput;if(this.pageStateBar){a=this.getPageInfo();Sigma.U.removeNode(this.pageStateBar.firstChild);if((a.endRowNum-a.startRowNum<1)&&(a.totalRowNum<1)){this.pageStateBar.innerHTML="<div>"+this.getMsg("NO_DATA")+"</div>"}else{this.pageStateBar.innerHTML="<div>"+Sigma.$msg(this.getMsg(c?"PAGE_STATE":"PAGE_STATE_FULL"),a.startRowNum,a.endRowNum,a.totalPageNum,a.totalRowNum,a.pageNum)+"</div>"}}}},createGridMenu:function(){if(!this.showGridMenu||!this.toolBarBox||!this.toolBar){return}var a=this;var e=a.id;this.gridMenuButton=new Sigma.Button({gridId:this.id,parentItem:this,container:this.toolBar,cls:"gt-tool-gridmenu",withSeparator:true});var j=!this.allowGroup?null:Sigma.createColumnDialog("group",{gridId:e,checkValid:function(i){return i.grouped},checkFn:"group",uncheckFn:"ungroup",checkType:a.multiGroup?"checkbox":"radio",canCheck:function(i){return i.filterable!==false&&!i.hidden}});var h=!this.allowFreeze?null:Sigma.createColumnDialog("freeze",{gridId:e,checkValid:function(i){return i.frozen},checkFn:"freeze",uncheckFn:"unfreeze",canCheck:function(i){return i.freezeable!==false&&!i.hidden}});var l=!this.allowHide?null:Sigma.createColumnDialog("show",{gridId:e,checkValid:function(i){return !i.hidden},checkFn:"show",uncheckFn:"hide",canCheck:function(i){return i.hideable!==false&&!i.frozen}});function f(i,m){if(!i){return}i.show();i.setTitle(m);a.gridMenuButton.closeMenu()}var b=this.toolbarPosition!="bottom"?"B":"T";function c(i){return function(){Sigma.Grid.changeSkin(a,i)}}var d=null;if(this.allowCustomSkin){d=new Sigma.MenuItem({gridId:this.id,type:"",text:this.getMsg("CHANGE_SKIN"),cls:"gt-icon-skin"});var k=[];for(var g=0;g<this.skinList.length;g++){k.push(new Sigma.MenuItem({gridId:this.id,type:"radiobox",text:this.skinList[g].text,checked:g===0,onclick:c(this.skinList[g].value)}))}d.addMenuItems(k,"R")}this.gridMenuButton.addMenuItems([d,j?new Sigma.MenuItem({gridId:a.id,type:"",text:a.getMsg("MENU_GROUP_COL"),cls:"gt-icon-groupcol",onclick:function(){f(j,a.getMsg("MENU_GROUP_COL"))}}):null,h?new Sigma.MenuItem({gridId:a.id,type:"",text:a.getMsg("MENU_FREEZE_COL"),cls:"gt-icon-freeze",onclick:function(){f(h,a.getMsg("MENU_FREEZE_COL"))}}):null,l?new Sigma.MenuItem({gridId:a.id,type:"",text:a.getMsg("MENU_SHOW_COL"),cls:"gt-icon-hidecol",onclick:function(){f(l,a.getMsg("MENU_SHOW_COL"))}}):null,new Sigma.MenuItem({gridId:this.id,type:"",text:SIGMA_GRID_VER})],b)},closeDialog:function(){this.activeDialog&&this.activeDialog.close();this.activeDialog=null},getSortInfo:function(){return this.sortInfo||[]},setTotalRowNum:function(a){this.getPageInfo().totalRowNum=a},getTotalRowNum:function(a){return this.getPageInfo(a).totalRowNum},addSkin:function(a){if(Sigma.$type(a,"string")){a={text:this.getMsg("STYLE_NAME_"+a.toUpperCase()),value:a.toLowerCase()}}this.skinList.push(a)},addRows:function(b){for(var a=0;a<b.length;a++){this.gridRowList.push(b[a])}},getFirstRow:function(){return this.gridTbodyList[0]?this.gridTbodyList[0].rows[0]:null},getRows:function(){return this.gridTbodyList[0].rows},getRow:function(a){if(Sigma.U.isNumber(a)){return this.getRows()[a]}return a},getRowNumber:function(){return this.rowNum},hasData:function(){return this.rowNum>0},dirty:function(a){Sigma.U.addClass(a,"gt-cell-updated")},selectFirstRow:function(){var a=this.getRow(0);if(a){this.selectRow(a,true)}},unselectAllRow:function(){var a=this;Sigma.$each(this.selectedRows,function(b){Sigma.U.removeClass(b,"gt-row-selected");a.syncTwinRowCell(b)});this.selectedRows=[];this.activeRow=null},getSelectedRecord:function(){return this.getRecordByRow(this.selectedRows[this.selectedRows.length-1])||this.activeRecord},getGridHTML:function(d,f){var c=this.getGridHeadHTML();f=f||[Sigma.T_G.bodyTableStart(this.id,false),c,"<tbody>"];var e=0;var b=this.dataset.getSize();var a=d?this.getPageInfo().pageSize:-1;f.push(this.getGridBodyHTML(e,b,a,f,null,true));return f.join("")},getGridHeadHTML:function(){var a=this.headTable.innerHTML;var b=a.toLowerCase().indexOf("<tr");var c=a.toLowerCase().lastIndexOf("</tr>");if(this.customHead){b=a.toLowerCase().indexOf("<tr",b+3)}a=a.substring(b,c+"</tr>".length);return"<!-- gt : head start  -->"+a+"<!-- gt : head end  -->"},getGridBodyHTML:function(q,c,o,m,r,d){var a=this;var e=a.colNum;var f=a.getGroupInfo(q,c);var n=" >",b=null,g=null,k=0,h="";for(var i=q;i<c;i++){b=a.dataset.getRecord(i);if(!b){break}var l=a.customRowAttribute(b,i,a)||"";var p=Sigma.T_G.rowStartS(a,i,l);if(!d){h=a.rowKey+a.getUniqueField(b);b[Sigma.Const.DataSet.ROW_KEY]=h;a.currentRowNum++;if(a.showIndexColumn){r.push(a.buildGridIndexRow(p+n,b,i,e))}}else{if(i>0&&o>0&&(i%o)===0){m.push("\n<!-- gt : page separator  -->\n")}}if(a.isNextGroup(b,g,i)){m.push(a.buildGroupGridRow(p+n,b,i,e))}var j=f[k++];m.push(a.buildGridRow(p+' id="'+h+'"'+n,b,i,e,j));g=b}m.push(Sigma.T_G.tableEndHTML)},getHiddenColumnStyle:function(a){var c=this;var d=[];Sigma.$each(c.columnList,function(f,e){if(f.hidden===true||(a&&f[a]===false)){d.push(f.CLASS_PREFIX+f.styleClass+" { display:none;width:0px; }");d.push(f.CLASS_PREFIX+f.innerStyleClass+" { display:none;width:0px; }")}});var b=d.join("\n");return Sigma.U.replaceAll(b,".gt-grid ","")},getAllRows:function(){var a=this;if(a.gridRowList.length===0){Sigma.$each(a.gridTbodyList,function(b){a.addRows(b.rows)})}return a.gridRowList},getAllFreezeRows:function(){var b=this;if(b.gridFreezeRowList.length===0){var c=b.freezeBodyTable.tBodies[0].rows;for(var a=0;a<c.length;a++){b.gridFreezeRowList.push(c[a])}}return b.gridFreezeRowList},filterHandler:{hide:function(b){b=b||this.filterInfo;var a=Sigma.Grid.filterCheck[b.checkType](b.value,b.checkValue);if(a){}else{}}},cleanActiveObj:function(){this.activeCell=null;this.activeRow=null;this.activeColumn=null;this.activeEditor=null;this.activeRecord=null;this.activeValue=null},cleanTable:function(c){this.closeGridMenu();if(this.endEdit()===false){return}this.lastOverHdCell=null;if(c!==false){this.cleanActiveObj();for(var b=0;b<this.selectedRows.length;b++){this.selectedRows[b]=null}this.selectedRows=[];this.overRow=null;this.overRowF=null}this.gridRowList=[];this.bodyFirstRow=null;for(var e=0;e<this.colNum;e++){var d=this.columnList[e];d.firstCell=null;d.frozenSortIcon=null;d.frozenHdTool=null;d.frozenHeadCell=null}var a=this;Sigma.$each(this.gridTbodyList,function(g,f){Sigma.U.removeNode(g);a.gridTbodyList[f]=null});Sigma.U.removeNode(this.gridTable);this.gridTable=null;this.gridTbodyList=[];this.cleanFreezeHead();if(this.freezeBodyTable){Sigma.U.removeNode(this.freezeBodyTable.tBodies[0],this.freezeBodyTable);this.freezeBodyTable=null}},destroy:function(){var c=this;Sigma.$invoke(this,"beforeDestroy");this.cleanTable();var f=["gridMenuButton","filterDialog","charDialog","navigator"];Sigma.$each(f,function(g,h){if(c[g]&&c[g].destroy){c[g].destroy()}c[g]=null});for(var a in this.tools){var b=this.tools[a];if(b&&b.destroy){b.destroy()}this.tools[a]=null}Sigma.U.removeNodeTree(this.gridDialogTitle);Sigma.U.removeNodeTree(this.gridDialogBody);Sigma.U.removeNodeTree(this.gridDialog);this.gridDialog=this.gridDialogBody=this.gridDialogTitle=null;for(var e=0;e<this.colNum;e++){var d=this.columnList[e];d.destroy()}Sigma.$each(this.domList,function(g,h){Sigma.U.removeNode(c[g]);c[g]=null});this.freezeBodyTable=this.gridTable=this.bodyFirstRow=this.lastOverHdCell=this.overRowF=this.overRow=null;this.gridFreezeRowList=[];this.selectedRows=[];this.cacheBodyList=[];this.frozenColumnList=[];this.sortedColumnList=[];this.checkedRows={};this.gridTbodyList=[];this.gridRowList=[];if(Sigma.activeGrid==this){Sigma.activeGrid=null}Sigma.GridCache[this.id]=null;delete Sigma.GridCache[this.id]},addRow:function(a,b){if(this.readOnly){return}this.insert(a,b)},deleteRow:function(f){var e=[].concat(f||this.selectedRows);for(var c=0;c<e.length;c++){f=e[c];var b=this.getRecordByRow(f);if(f!=this.activeRow){this.selectRow(f,false)}if(!b){continue}if(this.isInsertRow(f)){if(this.activeCell&&this.activeRow==f){this.cleanActiveObj()}var a=this.getTwinRows(f);Sigma.U.removeNode(a[0],a[1]);this.dataset.deleteRecord(b);this.toggleEmptyRow();continue}if(Sigma.$invoke(this,"beforeDelete",[b,f,this])!==false){var d=this.dataset.isDeletedRecord(b);if(!d){this.dataset.deleteRecord(b);Sigma.U.addClass(f,"gt-row-del")}else{this.dataset.undeleteRecord(b);Sigma.U.removeClass(f,"gt-row-del")}this.syncTwinRowCell(f)}}},selectRow:function(g,d){if(d){var f=[].concat(g);for(var c=0,a=f.length;c<a;c++){g=this.getRow(f[c]);if(!this.isEmptyRow(g)){var e=g.rowIndex;var b=this.getRecordByRow(g);if(Sigma.$invoke(this,"beforeRowSelect",[b,g,e,this])!==false){Sigma.U.addClass(g,"gt-row-selected");this.syncTwinRowCell(g);this.selectedRows.push(g);this.activeRow=g;Sigma.$invoke(this,"afterRowSelect",[b,g,e,this])}}}}else{if(g){Sigma.U.removeClass(g,"gt-row-selected");this.syncTwinRowCell(g);Sigma.U.remove(this.selectedRows,g)}}},addParameters:function(a,b){this.parameters=Sigma.U.add2Map(a,b,this.parameters)},cleanContent:function(){this.setContent({data:[],pageInfo:{pageNum:1,totalPageNum:1,totalRowNum:0,startRowNum:0}})},cleanParameters:function(){this.parameters={}},closeGridMenu:function(){if(this.gridMenuButton){this.gridMenuButton.closeMenu()}},endEdit:function(){if(this.activeEditor&&this.activeEditor.locked===true||(this.activeDialog!=this.activeEditor)&&this.activeDialog&&!this.activeDialog.hidden){return false}if(this.activeCell&&this.activeEditor&&(this.activeColumn.editable||this.isInsertRow(this.activeRow))){this.hideEditor();this.editing=false;this.syncTwinRowCell(null,this.activeCell)}},exportGrid:function(h,f,b,c,d){var a=this;if(Sigma.$invoke(a,"beforeExport",[h,f,b,c,d,a])!==false){try{h=h||this.exportType;f=f||this.exportFileName;b=b||this.exportURL;c=c||this.jsonParamName||(this.ajax?this.ajax.jsonParamName:Sigma.AjaxDefault.paramName);d="export";if(this.html2pdf&&h=="pdf"){this.gridFormTextarea.name="__gt_html";var i=['<style type="text/css">',this.getHiddenColumnStyle("exportable"),"</style>"];this.gridFormTextarea.value=i.join("\n")+"\n"+this.getGridHTML(true)}else{var j=this.getLoadParam();j[this.CONST.action]=d;j[this.CONST.exportType]=h;j[this.CONST.exportFileName]=f;this.gridFormTextarea.name=c;this.gridFormTextarea.value=Sigma.$json(j)}this.gridFormFileName.value=f;this.gridFormExportType.value=h;this.gridForm.action=b;b&&(this.gridForm.submit());this.gridFormTextarea.value=""}catch(g){this.exportFailure({type:h,fileName:f},g)}}},getColumn:function(a){if(Sigma.U.isNumber(a)&&a>=0){return this.columnList[a]}else{if(Sigma.U.getTagName(a)=="TD"){return this.columnList[Sigma.U.getCellIndex(a)]}else{if(Sigma.$type(a)=="object"){return a}else{return this.columnMap[a]}}}},getCellValue:function(b,c){var e=this.getColumn(b);var a=this.getRecord(c);var d=a?a[e.fieldIndex]:null;return d},getColumnValue:function(a,b){return this.getCellValue(a,b)},getDeletedRecords:function(){return Sigma.$array(this.dataset.deletedRecords)},getDisplayColumns:function(c){var b=[];for(var d=0;d<this.columnList.length;d++){var a=this.columnList[d];if(a.hidden!==(c!==false)){b.push(a)}}return b},getEventTargets:function(b,c){c=c||Sigma.U.getEventTarget(b);var i=null,h=-1,a=-1,d=null,e=null,f=null;var g=Sigma.U.getParentByTagName("td",c,b);if(g){i=g.parentNode;h=Sigma.U.getCellIndex(g);a=i.rowIndex;d=this.columnList[h];e=this.getRecordByRow(i)||{};f=e[d.fieldIndex]}return{cell:g,row:i,colNo:h,rowNo:a,column:d,record:e,value:f,eventTarget:c}},getInsertedRecords:function(){return Sigma.$array(this.dataset.insertedRecords)},getRecord:function(b){var a;if(Sigma.U.isNumber(b)){a=b}else{if(Sigma.U.getTagName(b)=="TD"){return this.getRecordByRow(b.parentNode)}else{if(Sigma.U.getTagName(b)=="TR"){return this.getRecordByRow(b)}else{if(Sigma.$type(b,"object")&&!b.tagName){return b}else{if(this.selectedRows.length>0){a=this.selectedRows[this.selectedRows.length-1].getAttribute(Sigma.Const.DataSet.INDEX)/1}else{a=0}}}}}return this.dataset.getRecord(a)},getSelectedRecords:function(){var a=[];for(var b=0;b<this.selectedRows.length;b++){a.push(this.getRecordByRow(this.selectedRows[b]))}return a},getUpdatedRecords:function(){return Sigma.$array(this.dataset.updatedRecords)},hideCellToolTip:function(){if(this.toolTipDiv){this.toolTipDiv.style.display="none";this.gridEditorCache.appendChild(this.toolTipDiv);this.toolTipDiv.innerHTML=""}},hideDialog:function(){this.activeDialog&&this.activeDialog.hide();this.activeDialog=null},hideMask:function(){if(this.gridMask){this.gridMask.style.cursor="auto";this.gridMask.style.display="none"}this.pageSizeSelect},insert:function(a,c){a=a||this.cloneDefaultRecord()||(this.dataset.getRecordType()=="array"?[]:{});if(Sigma.$invoke(this,"beforeInsert",[a])!==false){this.dataset.insertRecord(a);a[Sigma.Const.DataSet.NOT_VAILD]=true;var f=this.rowKey+this.getUniqueField(a);a[Sigma.Const.DataSet.ROW_KEY]=f;var d=this.renderInsertedRow(a);this.bodyDiv.scrollTop=this.bodyDiv.scrollHeight;this.rowNum++;if(c!==false){var h=0;var g=-1;for(h=0;h<this.columnList.length;h++){var e=this.columnList[h];if(g<0&&!e.hidden&&e.editor){g=h}if(e.frozen&&d[1]){var b=d[0].cells[h].cloneNode(true);d[1].appendChild(b)}}}else{}this.syncScroll()}this.toggleEmptyRow()},printGrid:function(){var c=this,e;c.closeGridMenu();c.showWaiting();var d=[" body { margin :5px;padding:0px;}",".gt-table { width:100%;border-left:1px solid #000000 ; border-top:1px solid #000000; }",".gt-table TD { font-size:12px;padding:2px; border-right:1px solid #000000 ; border-bottom:1px solid #000000; }",".gt-hd-row TD { padding:3px; border-bottom:2px solid #000000 ;background-color:#e3e3e3; white-space:nowrap;word-break:keep-all;word-wrap:normal; }",".gt-hd-hidden { }",".gt-row-even {	background-color:#f6f6f6; }"];d.push(this.getHiddenColumnStyle("printable"));c.customPrintCss&&d.push(c.customPrintCss);d=d.join("\n");var g=c.getGridHTML();var f=Sigma.doc.activeElement;function b(h){h.writeln("<style>");h.writeln(d);h.writeln("</style>");h.writeln(g);h.close()}if(Sigma.isIE||Sigma.isGecko||Sigma.isSafari){e=c.gridIFrame.contentWindow.document;b(e);c.gridIFrame.contentWindow.focus();c.gridIFrame.contentWindow.print()}else{if(Sigma.isOpera){var a=window.open("");e=a.document;b(e);a.focus();Sigma.$thread(function(){a.print();Sigma.$thread(function(){a.close()},2000)})}}Sigma.$thread(function(){c.hideWaiting()},1000)},refresh:function(e){if(this.dataset&&e){this.dataset.setData(e)}var d=this;var a=d.scrollLeft,c=d.scrollTop;if(d.remotePaging===false){d.dataset.startRecordNo=(d.getPageInfo().startRowNum||1)-1}function b(){if(Sigma.$invoke(d,"beforeRefresh",[d])!==false){d.cleanTable();!d.remoteSort&&d._doSort();d.refreshGrid();d.autoUpdateSortState&&d.updateSortState();d.sorting=false;d.autoUpdateEditState&&d.updateEditState();d.updateCheckState();d.autoUpdateFreezeState&&d.updateFreezeState();d.refreshToolBar();d.syncScroll(a,c);Sigma.$invoke(d,"afterRefresh",[d]);d._onComplete()}}Sigma.$thread(b)},reload:function(b,a){if(a!==false||!this.dataset||this.dataset.getSize()<0){this.load(b,true)}else{this.refresh()}},render:function(a){if(!this.rendered){a=Sigma.getDom(a);this.container=a||this.container;this.initColumns();this.initCSS();this.createMain();this.createFormIFrame();this.createGridGhost();this.initToolbar();this.initMainEvent();this.createBody();this.rendered=true}return this},save:function(k){if(this.endEdit()===false){return}var c=this.saveURL;var f=this.getInsertedRecords();var o=this.getUpdatedRecords();var h=this.getDeletedRecords();var e=(f&&f.length>0||o&&o.length>0||h&&h.length>0);if(!k&&!e){alert(this.getMsg("NO_MODIFIED"))}else{var q=this.gridTable.tFoot?this.gridTable.tFoot.rows:[];for(var g=0,j=f.length;g<j;g++){var d=f[g];for(var l=0;l<this.columnList.length;l++){var b=this.columnList[l];if(b.editor){var m=d[b.fieldIndex];var n=q[g]?q[g].cells[b.colIndex]:null;if(this.validValue(b,m,d,n)!==true){return false}}}}var p=this.getSaveParam();p[this.CONST.action]="save";p[this.CONST.insertedRecords]=f;p[this.CONST.updatedRecords]=o;p[this.CONST.deletedRecords]=h;if(Sigma.$invoke(this,"beforeSave",[p,this])!==false){this.showWaiting();var a=this;return this.request(c,p,"json",function(i){return function(r){a.saveCallBack(r,p,i)}}(k),function(r,i){var s={};s[a.CONST.exception]=" XMLHttpRequest Status : "+r.status;a.saveFailure(s,i);a.hideWaiting()})}}if(k===true){this.load()}return false},setCellValue:function(c,b,d){var a=b;if(Sigma.U.isNumber(a)){a=this.dataset.getRecord(a)}this.update(a,this.columnMap[c].fieldName,d)},setColumnValue:function(b,a,c){return this.setCellValue(b,a,c)},setContent:function(b){var a=this.getPageInfo();if(Sigma.$type(b,"array")){b[this.dataRoot]=b}else{b[this.CONST.pageInfo]=b[this.dataPageInfo||this.CONST.pageInfo];if(b[this.CONST.recordType]){this.dataset.setRecordType(b[this.CONST.recordType])}if(b[this.CONST.pageInfo]){Sigma.$extend(a,b[this.CONST.pageInfo])}a.totalRowNum=b.totalRowNum||a.totalRowNum}if(b[this.dataRoot]&&Sigma.$invoke(this,"beforeDatasetUpdate",[b[this.dataRoot]])!==false){a.totalRowNum=a.totalRowNum||b[this.dataRoot].length;this.refresh(b[this.dataRoot])}else{this.refresh()}},showDialog:function(g){var e=this;switch(g){case"filter":e.filterDialog=e.filterDialog||Sigma.createFilterDialog({title:e.getMsg("DIAG_TITLE_FILTER"),gridId:e.id});e.filterDialog.show();break;case"chart":var b=e.activeCell?e.getRecordByRow(e.activeRow):e.getRecord();if(!b){break}var d=[];var c="";var a=300,f=300;if(b){e.charDialog=e.charDialog||new Sigma.Dialog({gridId:e.id,container:e.gridMask,id:"charDialog",width:a,height:f,autoRerender:true,title:e.getMsg("DIAG_TITLE_CHART")});e.charDialog.show();e.chart=new Sigma.Chart({swfPath:e.SigmaGridPath+"/flashchart/fusioncharts/charts/",width:a-3,height:f-23,container:e.charDialog.bodyDiv});Sigma.$each(e.columnList,function(j,h){if(j.chartCaption){c=j.chartCaption.replace("{@}",b[j.fieldIndex])}if(j.inChart){d.push([j.header||j.title,b[j.fieldIndex],j.chartColor||"66bbff"])}});e.chart.caption=e.chartCaption;e.chart.subCaption=c;e.chart.data=d;e.chart.generateChart()}break}},showMask:function(a){if(a||this.transparentMask){Sigma.U.addClass(this.gridMask,"gt-transparent")}else{Sigma.U.removeClass(this.gridMask,"gt-transparent")}this.gridMask&&(this.gridMask.style.display="block");this.pageSizeSelect},showWaiting:function(){this.showMask();if(this.gridWaiting&&!this.transparentMask){this.gridWaiting.style.display="block"}this.isWaiting=true},hideWaiting:function(){if(this.gridWaiting){this.gridWaiting.style.display="none"}this.hideMask();this.isWaiting=false},getFilterInfo:function(){return this.filterInfo||[]},setFilterInfo:function(a){this.filterInfo=a||[]},applyFilter:function(a){this.filterInfo=a||this.filterInfo||[];if(this.remoteFilter){this.reload();return}this.dataProxyBak=this.dataset.dataProxy;this.filterDataProxy=this.dataset.filterData(this.filterInfo);if(!this.remoteFilter&&this.justShowFiltered){this.dataset.dataProxy=this.filterDataProxy;this.refresh()}if(this.afterFilter){this.afterFilter(this.filterDataProxy)}if(this.tools.filterTool){if(this.filterInfo.length>0){Sigma.U.addClass(this.tools.filterTool.itemIcon,"gt-tool-filtered")}else{Sigma.U.removeClass(this.tools.filterTool.itemIcon,"gt-tool-filtered")}}return this.filterDataProxy},setDimension:function(d,a,f){var c=this;var b=[this.gridDiv.offsetWidth,this.gridDiv.offsetHeight];d=""+d;a=""+a;this.width=d;this.height=a;if(d.toLowerCase()=="auto"){this.width=b[0]+"px"}else{if(d.indexOf("%")<1&&d.indexOf("px")<1){this.width=Sigma.U.parseInt(d)+"px"}}if(a.toLowerCase()=="auto"){this.height=b[1]+"px"}else{if(a.indexOf("%")<1&&a.indexOf("px")<1){this.height=Sigma.U.parseInt(a)+"px"}}var e=false;if((a.indexOf("%")>1||d.indexOf("%")>1)&&this.monitorResize){e=true}if(e){if(Sigma.isIE){this.gridDiv.style.overflowY="hidden"}else{if(Sigma.isOpera){this.gridDiv.style.overflow="hidden"}}}c._onResize(f)},getDimension:function(){return{width:this.width,height:this.height}},getSkin:function(){return this.skin},setSkin:function(a){if(this.skin==a){return}this.skin=a;Sigma.Grid.changeSkin(this,a)},getPageInfo:function(a){return a?this.navigator.refreshState():this.navigator.pageInfo},setPageInfo:function(a){Sigma.$extend(this.getPageInfo(),a)},gotoPage:function(a){Sigma.$chk(a)&&(this.getPageInfo().pageNum=a);if(this.autoSaveOnNav){this.save(true)}else{this.load()}},forEachRow:function(d){var e=this.getRows();for(var c=0,a=e.length;c<a;c++){var f=e[c];var b=this.getRecordByRow(f);d(f,b,c,this)}},moveColumn:function(f,h,a){if(f==h){return}var b=this;var d=this.columnList.length;var g=a!==true&&this.freezeHeadDiv.style.display=="block"?this.frozenColumnList.length:0;h=h<g?g:h;var c=false,e;if(h>=d){h=d-1;h^=f;f^=h;h^=f;c=true}var j=this.getAllRows();Sigma.U.insertNodeBefore(this.columnList[f].headCell,this.columnList[h].headCell);for(e=0;e<j.length;e++){Sigma.U.insertNodeBefore(j[e].cells[f],j[e].cells[h])}Sigma.U.moveItem(this.columnList,f,h);for(e=0;e<d;e++){this.columnList[e].colIndex=e}},sortGrid:function(a){this.sortInfo=a||this.sortInfo;if(this.remoteSort){this.reload()}else{this.refresh()}},getCell:function(c,a){var b=this.getColumn(a);var d=this.getRow(c);return d.cells[b.getColumnIndex()]},focusCell:function(a){if(a&&!this.isGroupRow(a)){this.closeGridMenu();var b=a!=this.activeCell;if(b){Sigma.U.removeClass(this.activeCell,"gt-cell-actived"+(this.activeEditor?"-editable":""));this.syncTwinRowCell(null,this.activeCell)}this.syncActiveObj(a);b&&Sigma.U.addClass(this.activeCell,"gt-cell-actived"+(this.activeEditor?"-editable":""));if(this.activeColumn&&this.activeRecord){this.activeValue=this.activeRecord[this.activeColumn.fieldIndex]}this.scrollGrid();this.syncTwinRowCell(null,this.activeCell)}else{this.cleanActiveObj()}return a},editCell:function(a){this.focusCell(a);this.syncActiveObj(a);this.startEdit()},refreshRow:function(g,b){g=this.getRow(g);b=b||this.getRecordByRow(g);var e=g.getAttribute(Sigma.Const.DataSet.INDEX)/1;this.dataset.initValues(b,e,this.dataset);for(var c=0;c<g.cells.length;c++){var d=this.getColumn(c);if(d!=this.activeColumn&&d.syncRefresh===false){continue}var a=g.cells[c];var f=false;a.firstChild.innerHTML=d.renderer(b[d.fieldIndex],b,d,this,c,e)}},checkRow:function(e,c){e=this.getTwinRows(e)[0];for(var a=0;a<e.cells.length;a++){var d=this.getColumn(a);if(d.isCheckColumn){var b=e.cells[a].firstChild.firstChild;if(Sigma.U.getTagName(b)=="INPUT"&&b.type=="checkbox"&&Sigma.U.hasClass(b,"gt-f-check")){if(b.checked!==c){b.checked=c;if(this.selectRowByCheck){this.selectRow(e,c)}c?this.checkedRows[b.value]=true:delete this.checkedRows[b.value]}return}}}}};Sigma.Grid=Sigma.$class(Sigma.GridDefault);Sigma.$extend(Sigma.Grid,{isSelectedRow:function(a){return Sigma.U.hasClass(a,"gt-row-selected")},handleOverRowCore:function(a,b,c){if(!c||b.overRow==c){b.changingStyle=false;return}b.changingStyle=true;if(b.overRow){b.overRow.className=b.overRow.className.replace(" gt-row-over","")}c.className+=" gt-row-over";b.overRow=c;b.changingStyle=false;return c},handleOverRow:function(b,c,d){b=b||window.event;var e=Sigma.U.getParentByTagName("tr",null,b);if(c.isEmptyRow(e)){return}if(d==c.freezeBodyDiv&&e){var a=c.getRow(e.rowIndex);Sigma.Grid.handleOverRowCore(b,c,a);c.overRowF=e}else{Sigma.Grid.handleOverRowCore(b,c,e)}},startGridResize:function(a,c){a=a||window.event;c=Sigma.$grid(c);c.closeGridMenu();c.isGridResizing=true;c.resizeButton.style.cursor=c.gridGhost.style.cursor="se-resize";c.syncLeftTop();c.gridGhost.style.top=c.top+Sigma.doc.body.scrollTop+"px";c.gridGhost.style.left=c.left+Sigma.doc.body.scrollLeft+"px";var b=c.gridDiv.offsetWidth,d=c.gridDiv.offsetHeight;c.gridGhost.cx=a.clientX-b;c.gridGhost.cy=a.clientY-d;c.gridGhost.style.width=b+"px";c.gridGhost.style.height=d+"px";c.gridGhost.style.display="block"},endGridResize:function(b,c){var d=Sigma.U.parseInt(c.gridGhost.style.width)+"px";var a=Sigma.U.parseInt(c.gridGhost.style.height)+"px";c.gridGhost.style.cursor="auto";c.gridMask.style.display=c.gridGhost.style.display="none";c.isGridResizing=false;c.setDimension(d,a)},startColumnResize:function(a,c){a=a||window.event;if(c.resizable===false){return}var b=c.grid;b.mouseDown=true;if(a.ctrlKey){return}b.isColumnResizing=true;b.closeGridMenu();b.showMask(true);b.headDiv.style.cursor=b.gridMask.style.cursor="col-resize";b.resizeColumnId=c.id;var d=Sigma.U.getPageX(a);c.oldRightX=d-b.viewportXY[0];b.separateLineMinX=c.oldRightX+c.minWidth-c.headCell.offsetWidth;if(b.separateLine){b.separateLine.style.left=c.oldRightX+"px";b.separateLine.style.height=b.viewport.offsetHeight-2+"px";b.separateLine.style.display="block"}if(b.columnMoveS){b.columnMoveS.style.left=c.headCell.offsetLeft+((Sigma.isFF2||Sigma.isFF1)?0:b.tableMarginLeft)+"px";b.columnMoveS.style.display="block"}},startColumnMove:function(a,c){a=a||window.event;var b=c.grid;b.mouseDown=true;if(!a.ctrlKey||b.frozenColumnList[c.getColumnIndex()]){return}b.closeGridMenu();var e=Sigma.U.getPageX(a);var d=c.headCell.offsetLeft;b.columnMoveS.setAttribute("newColIndex",null);var f=b.headerGhost;f.setAttribute("colIndex",c.getColumnIndex());f.setAttribute("offsetX2",d-e);f.style.left=d+((Sigma.isFF2||Sigma.isFF1)?0:b.tableMarginLeft)+"px";f.style.width=c.headCell.offsetWidth-1+"px";f.style.display="block";f.innerHTML='<span style="padding-left:2px;" >'+Sigma.$getText(c.headCell)+"</span>"},doDocGridHandler:function(l,b){l=l||window.event;var c=Sigma.U.getPageX(l);if(b.separateLine&&b.separateLine.style.display=="block"){var h=c-b.viewportXY[0];h=h>b.separateLineMinX?h:b.separateLineMinX;b.separateLine.style.left=h+"px"}else{if(!b.customHead&&b.headerGhost&&b.headerGhost.style.display=="block"){var d=c-b.viewportXY[0]+b.headDiv.scrollLeft;b.headerGhost.style.left=c+((Sigma.isFF2||Sigma.isFF1)?0:b.tableMarginLeft)+b.headerGhost.getAttribute("offsetX2")/1+"px";var g=-1;var j=-1;for(var f=0;f<b.headFirstRow.cells.length;f++){var k=b.headFirstRow.cells[f];if(d>k.offsetLeft&&d<k.offsetLeft+k.offsetWidth){g=k.offsetLeft;j=f;break}}if(d<=k.offsetLeft){f=0}if(g>=0){b.columnMoveS.style.left=g+((Sigma.isFF2||Sigma.isFF1)?0:b.tableMarginLeft)+"px";b.columnMoveS.style.display="block"}else{b.columnMoveS.style.display="none"}b.columnMoveS.setAttribute("newColIndex",j)}else{if(b.isGridResizing){var e=l.clientX-b.gridGhost.cx;var a=l.clientY-b.gridGhost.cy;e=e<b.minWidth?b.minWidth:e;a=a<b.minHeight?b.minHeight:a;b.gridGhost.style.width=e+"px";b.gridGhost.style.height=a+"px"}}}},endDocGridHandler:function(i,b){i=i||window.event;b=Sigma.$grid(b);var c=Sigma.U.getPageX(i);b.mouseDown=false;if(b.separateLine&&b.separateLine.style.display=="block"){var a=b.columnMap[b.resizeColumnId];a.newRightX=c-b.viewportXY[0];var g=a.newRightX-a.oldRightX;var e=g+parseInt(a.width);a.setWidth(e);b.resizeColumnId=-1;b.separateLine.style.display=b.columnMoveS.style.display="none";b.headDiv.style.cursor="auto";b.hideMask();b.syncScroll();if(!Sigma.isOpera){b.isColumnResizing=false}Sigma.$invoke(b,"afterColumnResize",[a,e,b])}else{if(!b.customHead&&b.headerGhost&&b.headerGhost.style.display=="block"){var d=Sigma.isIE?i.x:i.pageX;var h=b.columnMoveS.getAttribute("newColIndex");var f=b.headerGhost.getAttribute("colIndex");if(h!==null&&(h+"").length>0&&f!==null&&(f+"").length>0){h=h/1;if(h<0){h=b.columnList.length}if(Sigma.$invoke(b,"beforeColumnMove",[f/1,h/1,b])!==false){b.moveColumn(f/1,h/1);b.syncScroll()}}b.columnMoveS.style.display="none";b.columnMoveS.setAttribute("newColIndex",null);b.headerGhost.style.display="none";b.headerGhost.setAttribute("colIndex",null);b.headerGhost.style.cursor="auto"}else{if(b.isGridResizing){Sigma.Grid.endGridResize(i,b)}}}},changeSkin:function(c,a){c=Sigma.$grid(c);var d=c.gridDiv.className.split(" ");for(var b=0;b<d.length;b++){if(d[b].indexOf(Sigma.Const.Grid.SKIN_CLASSNAME_PREFIX)===0){d[b]=""}}d.push(Sigma.Const.Grid.SKIN_CLASSNAME_PREFIX+a);c.gridDiv.className=d.join(" ")},createCheckColumn:function(e,c){var h=c.id;e=Sigma.$grid(e);var b=e.id;var d=c.checkValid;var f=c.checkValue;var a=c.checkType||"checkbox";if(!f){f=Sigma.$chk(c.fieldIndex)?'record["'+c.fieldIndex+'"];':"grid.getUniqueField(record);"}if(typeof f=="string"){f=new Function("value","record","col","grid","colNo","rowNo",["return ",f].join(""))}if(!d){d=function(o,m,i,l,n,j,k){return n.checkedRows[o]}}c.header="";c.title=c.title||e.getMsg("CHECK_ALL");c.width=30;c.resizable=false;c.printable=false;c.sortable=false;var g="gt_"+b+"_chk_"+h;c.hdRenderer=function(i,k,j){return'<input type="'+a+'" class="gt-f-totalcheck" name="'+g+'" />'};c.renderer=function(n,i,m,p,j,l){var o=f(n,i,m,p,j,l);var k=d(o,n,i,m,p,j,l)?'checked="checked"':"";return'<input type="'+a+'" class="gt-f-check" value="'+o+'" '+k+' name="'+g+'" />'};return c}});Sigma.Grid.prototype.initGrid=Sigma.Grid.prototype.render;Sigma.$extend(Sigma.Grid,{render:function(a){a=Sigma.$grid(a);return function(){a.render()}},initColumnEvent:function(c,d,a,f){a=a||d.headCell;if(!a){return}f=f||Sigma.Grid.getSortIcon(d,a);var b=Sigma.U.nextElement(f);var e=Sigma.U.nextElement(b);d.hdTool=d.hdTool||Sigma.Grid.getHdTool(d,a);d.sortIcon=d.sortIcon||f;d.menuButton=d.menuButton||b;d.separator=d.separator||e;if(d.separator&&d.resizable===false){d.separator.style.display="none"}Sigma.U.addEvent(a,"mousedown",function(g){c.activeMe();if(c.endEdit()===false){return}c.closeGridMenu();if(!c.customHead){Sigma.U.stopEvent(g);Sigma.Grid.startColumnMove(g,d)}});Sigma.U.addEvent(a,"click",function(i){var j=Sigma.U.getEventTarget(i);if(!c.isColumnResizing){Sigma.$invoke(c,"onHeadClick",[i,a,d,c]);if(Sigma.U.getTagName(j)=="INPUT"&&j.type=="checkbox"&&Sigma.U.hasClass(j,"gt-f-totalcheck")){Sigma.checkTotalBox(j,c,d)}else{if(d.sortable&&j.className!="gt-hd-button"){c.lastAction="sort";c.sorting=true;var h=d.sortOrder=="asc"?"desc":(d.sortOrder=="desc"&&d.enableDefaultSort?"defaultsort":"asc");var g=c.createSortInfo(d);g.sortOrder=h;c.addSortInfo(g);c.sortGrid()}}}if(Sigma.isOpera){c.isColumnResizing=false}});if(d.resizable){e.colID=d.id;e.style.cursor="col-resize";Sigma.U.addEvent(e,"mousedown",function(g){c.activeMe();Sigma.U.stopEvent(g);Sigma.Grid.startColumnResize(g,d)})}if(!d.sortable&&!d.resizable&&d.hdTool){d.hdTool.style.display="none"}},getHdTool:function(b,a){var c=Sigma.U.firstChildElement(a||b.headCell);return Sigma.U.lastChildElement(c)},getSortIcon:function(b,a){var c=Sigma.Grid.getHdTool(b,a);return Sigma.U.firstChildElement(c)},mappingRenderer:function(b,a){return function(c){return b[c]||(a===undefined||a===null?c:a)}},findGridByElement:function(d){var b="DIV";var c="gt-grid";var a="";while((d=d.parentNode)){if(Sigma.U.getTagName(d)==b&&Sigma.U.hasClass(d,c)){a=d.id;break}}if(a.indexOf("_div")===a.length-4){a=a.substring(0,a.length-4)}return Sigma.$grid(a)}});var Ext=Ext||null;(Ext&&Ext.reg)&&(Ext.reg("gtgrid",Sigma.Grid));Sigma.checkOneBox=function(d,e,c){e=Sigma.$grid(e);d=Sigma.$(d);if(d.checked==c){return c}var a=Sigma.U.getParentByTagName("td",d);var f=a.parentNode;var b=e.getTwinRows(f)[0];if(c===true||c===false){if(Sigma.$invoke(this,"onRowCheck",[b,c,e])===false){return !!d.checked}d.checked=c}if(d.checked){e.checkedRows[d.value]=true;if(e.selectRowByCheck){e.selectRow(b,true)}}else{delete e.checkedRows[d.value];if(e.selectRowByCheck){e.selectRow(b,false)}}return !!d.checked};Sigma.checkTotalBox=function(l,c,a,f){c=Sigma.$grid(c);l=Sigma.$(l);if(f!==null&&f!==undefined){l.checked=f}var m=Sigma.U.getParentByTagName("td",l);var b=Sigma.U.getCellIndex(m);var g=l.checked;var o=a.frozen?c.getAllFreezeRows():c.getAllRows();for(var e=0,d=o.length;e<d;e++){var n=o[e];var h=n.cells[b];if(h){var k=h.getElementsByTagName("input")[0];Sigma.checkOneBox(k,c,g)}}};Sigma.initGlobalEvent=function(){if(Sigma.initGlobalEvent.inited){return}var a=Sigma.isIE?Sigma.doc.body:Sigma.doc;Sigma.U.addEvent(a,"mousemove",function(b){Sigma.activeGrid&&Sigma.Grid.doDocGridHandler(b,Sigma.activeGrid)});Sigma.U.addEvent(a,"mouseup",function(b){Sigma.activeGrid&&Sigma.Grid.endDocGridHandler(b,Sigma.activeGrid)});Sigma.U.addEvent(a,"click",function(b){Sigma.activeGrid&&(Sigma.activeGrid.endEdit()||Sigma.activeGrid.closeGridMenu())});Sigma.initGlobalEvent.inited=true};